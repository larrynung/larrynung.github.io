---
layout: post
title: ".NET 4.0 New Feature - StringBuilder.Clear"
date: 2010-10-20 09:12:02
comments: true
tags: [VB.NET]
description: ".NET 4.0 New Feature - StringBuilder.Clear"
---
<p>以往在使用StringBuilder時，若要重覆使用現有的StringBuilder物件，必需要將StringBuilder的內容清空，然而在StringBuilder類別中並未附有直覺的方法可供直接叫用，因此我們可能需要透過StringBuilder.Remove方法來清空內容。 </p>    <div class="wlWriterSmartContent" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:39d0aa6b-7c6c-473e-b9cc-be60df036712" style="padding-right: 0px; display: inline; padding-left: 0px; float: none; padding-bottom: 0px; margin: 0px; padding-top: 0px"><pre name="code" class="vb">
Dim str = New StringBuilder()
...
str.Remove(0, str.Length)
...</pre></div>  <p> </p>  <p> </p>  <p>或是透過把StringBuilder.Length設為0的方式來清除內容。 </p>    <div class="wlWriterSmartContent" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:f1db4c46-efa8-467b-b328-e1d3aa84d401" style="padding-right: 0px; display: inline; padding-left: 0px; float: none; padding-bottom: 0px; margin: 0px; padding-top: 0px"><pre name="code" class="vb">
Dim str = New StringBuilder()
...
str.Length = 0
...</pre></div>  <p>  </p>    <p>但這樣的做法總是有點不直覺，撰寫上也不太方便，因此在.NET 4.0中StringBuilder類別多加了Clear方法可以直接叫用，該方法把StringBuilder.Length設為0的方式給包裝了起來，直接叫用就可以清除掉StringBuilder中的內容。</p>  <div class="wlWriterSmartContent" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:f6e70940-245d-4ae9-906d-7b378d15c665" style="padding-right: 0px; display: inline; padding-left: 0px; float: none; padding-bottom: 0px; margin: 0px; padding-top: 0px"><pre name="code" class="vb">
Dim str = New StringBuilder()
...
str.Clear()
...</pre></div>  <p> </p>  <p>這邊將三種方法做個測試比較，測試程式如下：</p>  <div class="wlWriterSmartContent" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:753df2cc-123c-4d5c-999c-9a2ac78c08a9" style="padding-right: 0px; display: inline; padding-left: 0px; float: none; padding-bottom: 0px; margin: 0px; padding-top: 0px"><pre name="code" class="vb">
Imports System.Text

Module Module1

    Sub Main()
        Dim str As New StringBuilder
        Dim size As Integer = 100000000

        Dim sw As New Stopwatch

        '預先編譯降低測試誤差
        AppendData(str, size)
        ClearData1(str)
        ClearData2(str)
        ClearData3(str)

        '開始測試
        AppendData(str, size)
        Console.WriteLine("Test Remove...")
        sw.Restart()
        ClearData1(str)
        Console.WriteLine(sw.ElapsedMilliseconds)

        AppendData(str, size)
        Console.WriteLine("Test Length...")
        sw.Restart()
        ClearData2(str)
        Console.WriteLine(sw.ElapsedMilliseconds)

        AppendData(str, size)
        Console.WriteLine("Test Clear...")
        sw.Restart()
        ClearData3(str)
        Console.WriteLine(sw.ElapsedMilliseconds)
    End Sub

    Private Sub AppendData(ByVal str As StringBuilder, ByVal size As Integer)
        str.Append(New String("0", size))
    End Sub

    Private Sub ClearData1(ByVal str As StringBuilder)
        str.Remove(0, str.Length)
    End Sub

    Private Sub ClearData2(ByVal str As StringBuilder)
        str.Length = 0
    End Sub

    Private Sub ClearData3(ByVal str As StringBuilder)
        str.Clear()
    End Sub

End Module</pre></div>  <p> </p>  <p>感覺速度上是沒有太大的差異，挑自己順手的方法寫就好了。</p>  <p><img style="border-top-width: 0px; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="187" alt="image" width="425" border="0" src="\images\posts\18474\image_thumb.png" /></a></p>  <p> </p>  <h2>Link</h2>  <ul>   <li><a target="_blank" href="http://msdn.microsoft.com/zh-tw/library/system.text.stringbuilder.clear.aspx">StringBuilder.Clear 方法</li> </ul><p> </p>