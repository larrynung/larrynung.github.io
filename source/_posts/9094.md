---
layout: post
title: "[VB.NET]從登錄檔中讀取CPU資訊"
date: 2009-07-03 12:00:52
comments: true
tags: [VB.NET]
description: "[VB.NET]從登錄檔中讀取CPU資訊"
---
<p>要由登錄檔中讀取CPU資訊。首先，我們必需要了解CPU資訊是存放在登錄檔的何處。讓我們看一下下圖：</p><p><img style="border-right-width: 0px; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" border="0" alt="image" width="644" height="411" src="\images\posts\9094\image_thumb.png" /></p><p> </p><p>由圖中可知，CPU資訊是存放在[HKEY_LOCAL_MACHINE\HARDWARE\DESCRIPTION\System\CentralProcessor]中，其中~MHZ是指CPU的時脈、ProcessorNameStrin是CPU詳細描述文字、VendorIdentifier是指製造廠商。</p><p>了解了CPU資訊在登錄檔中存放的位置後，我們只要能透過程式到對應的位置讀取出值來，一個簡單的CPU資訊獲取程式就完成了。</p><p> </p><p>完整範例如下：</p><div style="width: 594px; height: 346px; overflow: auto"><div class="csharpcode"><pre class="alt"><span class="kwrd">Imports</span> Microsoft.Win32</pre><pre>
 </pre><pre class="alt"><span class="kwrd">Public</span> <span class="kwrd">Class</span> Form1</pre><pre>
 </pre><pre class="alt">
    <span class="kwrd">Private</span> <span class="kwrd">Sub</span> Form1_Load(<span class="kwrd">ByVal</span> sender <span class="kwrd">As</span> System.<span class="kwrd">Object</span>, <span class="kwrd">ByVal</span> e <span class="kwrd">As</span> System.EventArgs) <span class="kwrd">Handles</span> <span class="kwrd">MyBase</span>.Load</pre><pre>
        <span class="kwrd">Dim</span> key <span class="kwrd">As</span> RegistryKey = My.Computer.Registry.LocalMachine.OpenSubKey(<span class="str">"HARDWARE"</span>) _</pre><pre class="alt">
            .OpenSubKey(<span class="str">"DESCRIPTION"</span>) _</pre><pre>
            .OpenSubKey(<span class="str">"SYSTEM"</span>) _</pre><pre class="alt">
            .OpenSubKey(<span class="str">"CENTRALPROCESSOR"</span>) _</pre><pre>
            .OpenSubKey(<span class="str">"0"</span>)</pre><pre class="alt">
        <span class="kwrd">With</span> <span class="kwrd">Me</span></pre><pre>
            .tbxVendor.Text = key.GetValue(<span class="str">"VendorIdentifier"</span>).ToString</pre><pre class="alt">
            .tbxCPUName.Text = key.GetValue(<span class="str">"ProcessorNameString"</span>).ToString</pre><pre>
            .tbxCPUMHz.Text = key.GetValue(<span class="str">"~MHz"</span>).ToString</pre><pre class="alt">
        <span class="kwrd">End</span> <span class="kwrd">With</span></pre><pre>
    <span class="kwrd">End</span> <span class="kwrd">Sub</span></pre><pre class="alt"><span class="kwrd">End</span> <span class="kwrd">Class</span></pre></div></div><p /><style type="text/css"><![CDATA[

.csharpcode, .csharpcode pre
{
	font-size: small;
	color: black;
	font-family: consolas, "Courier New", courier, monospace;
	background-color: #ffffff;
	/*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
	background-color: #f4f4f4;
	width: 100%;
	margin: 0em;
}
.csharpcode .lnum { color: #606060; }]]></style><p> </p><p>執行結果：</p><p><img style="border-right-width: 0px; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" border="0" alt="image" width="304" height="144" src="\images\posts\9094\image_thumb_2.png" /></p>