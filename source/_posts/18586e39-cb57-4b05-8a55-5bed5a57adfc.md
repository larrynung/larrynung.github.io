---
layout: post
title: "Tkinter's tkFileDialog"
date: 2013-11-06 12:00:00
comments: true
tags: [Python]
description: "Tkinter's tkFileDialog"
---
<p>
	要使用Tkinter的tkFileDialog，首先要先將tkFileDialog package import進來。</p>
<div class="wlWriterSmartContent" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:cd3444f6-b322-4bd7-be1c-eb18a458c7b1" style="float: none; padding-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px">
	<pre class="py" name="code">
import tkFileDialog</pre>
</div>
<p>
	 </p>
<p>
	tkFileDialog 的用法大概像下面這樣，依使用需求呼叫不同的方法，並帶入參數就可以了。</p>
<div class="wlWriterSmartContent" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:6002c36f-5b1f-40b8-9e71-e034b024d589" style="float: none; padding-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px">
	<pre class="py" name="code">
tkFileDialog.FunctionName(options)</pre>
</div>
<p>
	 </p>
<p>
	參數的部分可以帶入 title、filetypes、initialdir、initialfile、multiple、parent、defaultextension 等 (視方法不同可帶入的參數可能會有所不同)，分別對應到的是對話框標題、對話框可選擇的檔案類型、初始的目錄、初始的檔案位置、是否支援多選、父視窗、以及預設的附檔名。</p>
<div class="wlWriterSmartContent" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:182652ec-376e-464b-821a-7659a115d170" style="float: none; padding-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px">
	<pre class="py" name="code">
...
options = {}
options['filetypes'] = [("allfiles","*"),("text","*.txt")]
options['initialdir'] = "c:\\"
options['multiple'] = True
options['title'] = "tkFileDialog.askopenfilename"
...</pre>
</div>
<p>
	 </p>
<p>
	可以呼叫的方法有askopenfilename、asksaveasfilename、askopenfilenames、askopenfile、askopenfiles、asksaveasfile、與askdirectory。</p>
<p>
	 </p>
<p>
	以askopenfilename來說...</p>
<div class="wlWriterSmartContent" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:b4657342-3e93-45f1-b82a-afcecce5be2f" style="float: none; padding-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px">
	<pre class="py" name="code">
...
options['title'] = "tkFileDialog.askopenfilename"
print tkFileDialog.askopenfilename(**options) or "Without selected!"
...</pre>
</div>
<p>
	 </p>
<p>
	就是我們一般看到的開啟檔案對話框，方法回傳值為選取的檔案位置。</p>
<p>
	<img alt="image" border="0" height="484" src="\images\posts\18586e39-cb57-4b05-8a55-5bed5a57adfc\image_thumb.png" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px" width="644" /></p>
<p>
	 </p>
<p>
	askopenfilenames 也是一般的開啟檔案對話框，等同於askopenfilename加設multiple參數。這個方法在python 2.6後回傳值從陣列變為字串 (也許是前面提到的multiple參數的關係)，所以在取得選取的檔案時我們必須做些處理，可以自行切割，或是透過Tkinter內建的splitlist將字串轉回陣列。</p>
<div class="wlWriterSmartContent" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:7874e210-472b-49a2-ba5c-e8095f1d201c" style="float: none; padding-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px">
	<pre class="py" name="code">
...
options['title'] = "tkFileDialog.askopenfilenames"
print Tk().tk.splitlist(tkFileDialog.askopenfilenames(**options)) or "Without selected!"
...</pre>
</div>
<p>
	 </p>
<p>
	askopenfile 跟askopenfilename類似，也是一般的開啟檔案對話框，只是其回傳值改為File物件，可用來直接進一步存取檔案內容。</p>
<div class="wlWriterSmartContent" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:2075b033-72d5-4ec5-bed7-684f8108c129" style="float: none; padding-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px">
	<pre class="py" name="code">
...
options['title'] = "tkFileDialog.askopenfile"
fs = tkFileDialog.askopenfile(**options) 

if fs:
	print fs.name
else:
	print "Without selected!"
...</pre>
</div>
<p>
	 </p>
<p>
	askopenfiles 也是開啟一般開啟對話框，可供多選並傳回File物件的陣列。</p>
<div class="wlWriterSmartContent" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:a13cb3f6-ead7-4234-8fd1-0e4412a48c37" style="float: none; padding-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px">
	<pre class="py" name="code">
...
options['title'] = "tkFileDialog.askopenfiles"
files = tkFileDialog.askopenfiles(**options)

print files

if files:
	for fs in files:
		print fs.name
else:
	print "Without selected!"
...</pre>
</div>
<p>
	 </p>
<p>
	但這個方法在Python中好像有些問題，所以在運行時會出現錯誤。</p>
<p>
	<img alt="image" border="0" height="109" src="\images\posts\18586e39-cb57-4b05-8a55-5bed5a57adfc\image_thumb_4.png" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px" width="576" /></p>
<p>
	 </p>
<p>
	錯誤發生的原因可參閱tkFileDialog.py。就筆者看來可能是因為Python 2.6以後askopenfilenames的回傳值從陣列改為字串，這邊卻未跟著修正...</p>
<p>
	<img alt="image" border="0" height="340" src="\images\posts\18586e39-cb57-4b05-8a55-5bed5a57adfc\image_thumb_7.png" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px" width="527" /></p>
<p>
	 </p>
<p>
	此外，tkFileDialog也可以叫出儲存對話框。我們可以改呼叫asksaveasfilename方法，該方法回傳值為選取的檔案名稱。</p>
<div class="wlWriterSmartContent" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:f11fe0e5-8760-4e31-96fe-b3a0830c07ac" style="float: none; padding-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px">
	<pre class="py" name="code">
...
options['title'] = "tkFileDialog.asksaveasfilename"
options['defaultextension'] = '.txt'
del options['multiple']
print tkFileDialog.asksaveasfilename(**options) 
...</pre>
</div>
<p>
	 <img alt="image" border="0" height="484" src="\images\posts\18586e39-cb57-4b05-8a55-5bed5a57adfc\image_thumb_1.png" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px" width="644" /></p>
<p>
	 </p>
<p>
	也可以改呼叫asksaveasfile方法，回傳值會從字串改為File物件，可直接用來寫入檔案內容。</p>
<div class="wlWriterSmartContent" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:a67690ed-1f95-4b0e-a1e4-d121165605ab" style="float: none; padding-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px">
	<pre class="py" name="code">
...
del options['filetypes']
del options['defaultextension']
options['title'] = "tkFileDialog.asksaveasfile"

print tkFileDialog.asksaveasfile(**options).name
...</pre>
</div>
<p>
	 </p>
<p>
	若要叫出開啟目錄對話框，可以改呼叫askdirectory方法。</p>
<div class="wlWriterSmartContent" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:9cd9e305-c0d3-4f27-b11a-10b86efb9854" style="float: none; padding-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px">
	<pre class="py" name="code">
...
options['title'] = "tkFileDialog.askdirectory"
print tkFileDialog.askdirectory(**options) 
...</pre>
</div>
<p>
	<img alt="image" border="0" height="386" src="\images\posts\18586e39-cb57-4b05-8a55-5bed5a57adfc\image_thumb_6.png" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px" width="381" /></p>
<p>
	 </p>
<p>
	最後附上筆者測試用的完整範例：</p>
<div class="wlWriterSmartContent" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:00e0375e-2b40-406a-a1fd-c4b5d6b05e95" style="float: none; padding-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px">
	<pre class="py" name="code">
from Tkinter import *
import tkFileDialog   

options = {}
options['filetypes'] = [("allfiles","*"),("text","*.txt")]
options['initialdir'] = "c:\\"
options['multiple'] = True

options['title'] = "tkFileDialog.askopenfilename"
print tkFileDialog.askopenfilename(**options) or "Without selected!"

options['title'] = "tkFileDialog.askopenfilenames"
print Tk().tk.splitlist(tkFileDialog.askopenfilenames(**options)) or "Without selected!"

options['title'] = "tkFileDialog.askopenfile"
fs = tkFileDialog.askopenfile(**options) 

if fs:
	print fs.name
else:
	print "Without selected!"

options['title'] = "tkFileDialog.askopenfiles"
files = tkFileDialog.askopenfiles(**options)

print files

if files:
	for fs in files:
		print fs.name
else:
	print "Without selected!"


options['title'] = "tkFileDialog.asksaveasfilename"
options['defaultextension'] = '.txt'
del options['multiple']
print tkFileDialog.asksaveasfilename(**options) 

del options['filetypes']
del options['defaultextension']
options['title'] = "tkFileDialog.asksaveasfile"

print tkFileDialog.asksaveasfile(**options).name

options['title'] = "tkFileDialog.askdirectory"
print tkFileDialog.askdirectory(**options) </pre>
</div>
<p>
	 </p>
<h2>
	Link</h2>
<ul>
	<li>
		tkFileDialog - Tkinter Wiki</li>
</ul>
