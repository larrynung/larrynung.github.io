---
title: Two-phase commit protocol
date: 2019-05-02 07:52:40
tags:
---

Two-phase commit protocol 簡稱 2PC，是用來解決分散式服務架構下各服務之間交易資料一致性問題的演算法。  

<!-- More -->

</br>


2PC 會有協調者與參與者兩個角色，參與者就是系統中的服務，協調者負責協調參與者。  

</br>


整個流程如下:  
1. 首先協調者會先通知需要參與的參與者做準備
2. 參與者收到通知後做準備
3. 參與者將準備結果告知協調者
4. 協調者匯整參與者的回報
5. 決定要提交還是回滾交易
6. 通知參與者提交或回滾交易

</br>


交易的提交或回滾協調者會由參與者的回報決定，如果所有需參與的參與者都準備成功，就提交交易。反之，若有需參與的參與者準備失敗，則回滾交易。  

</br>


整個流程做起來會像這樣。  

{% asset_img 1.png %}

</br>享受


該演算法雖然能解決分散式交易的問題，但因為是阻塞式的演算法，交易存留時間會比較長，會有效能上的問題。  
