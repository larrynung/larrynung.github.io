---
layout: post
title: "[VB.NET]自定義ComboBox下拉清單選項"
date: 2009-06-15 11:09:17
comments: true
categories: [VB.NET]
description: "[VB.NET]自定義ComboBox下拉清單選項"
---
<h2>實作步驟</h2><p><strong>Step1.ComboBox.DrawMode設為OwnerDrawFixed或OwnerDrawVariable</strong></p><p><img style="border-right-width: 0px; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" border="0" alt="image" width="268" height="31" src="\images\posts\8827\image_thumb.png" /></p><p> </p><p><strong>Step2.在ComboBox.DrawItem事件中重繪ComboBox下拉清單選項</strong></p><p> </p><h2>程式範例</h2><p>VB.NET</p><div style="width: 654px; height: 312px; overflow: auto"><div class="csharpcode"><pre class="alt"><span class="kwrd">Public</span> <span class="kwrd">Class</span> Form1</pre><pre>
 </pre><pre class="alt">
    <span class="kwrd">Private</span> <span class="kwrd">Sub</span> Form1_Load(<span class="kwrd">ByVal</span> sender <span class="kwrd">As</span> System.<span class="kwrd">Object</span>, <span class="kwrd">ByVal</span> e <span class="kwrd">As</span> System.EventArgs) <span class="kwrd">Handles</span> <span class="kwrd">MyBase</span>.Load</pre><pre>
        ComboBox1.DisplayMember = <span class="str">"Color"</span></pre><pre class="alt">
        ComboBox1.Items.Add(Brushes.Cyan)</pre><pre>
        ComboBox1.Items.Add(Brushes.Yellow)</pre><pre class="alt">
    <span class="kwrd">End</span> <span class="kwrd">Sub</span></pre><pre>
 </pre><pre class="alt">
    <span class="kwrd">Private</span> <span class="kwrd">Sub</span> ComboBox1_DrawItem(<span class="kwrd">ByVal</span> sender <span class="kwrd">As</span> System.<span class="kwrd">Object</span>, <span class="kwrd">ByVal</span> e <span class="kwrd">As</span> System.Windows.Forms.DrawItemEventArgs) <span class="kwrd">Handles</span> ComboBox1.DrawItem</pre><pre>
        <span class="kwrd">Dim</span> cmb <span class="kwrd">As</span> ComboBox = <span class="kwrd">DirectCast</span>(sender, ComboBox)</pre><pre class="alt">
        <span class="kwrd">Dim</span> brush <span class="kwrd">As</span> SolidBrush = <span class="kwrd">DirectCast</span>(cmb.Items(e.Index), SolidBrush)</pre><pre>
        <span class="kwrd">Dim</span> g <span class="kwrd">As</span> Graphics = e.Graphics</pre><pre class="alt">
        e.DrawBackground()</pre><pre>
        e.DrawFocusRectangle()</pre><pre class="alt">
        <span class="kwrd">Dim</span> rect <span class="kwrd">As</span> Rectangle = e.Bounds</pre><pre>
        rect.Offset(2, 2)</pre><pre class="alt">
        rect.Width = 20</pre><pre>
        rect.Height -= 4</pre><pre class="alt">
        g.DrawRectangle(Pens.Black, rect)</pre><pre>
 </pre><pre class="alt">
        rect.Offset(1, 1)</pre><pre>
        rect.Width -= 1</pre><pre class="alt">
        rect.Height -= 1</pre><pre>
        g.FillRectangle(brush, rect)</pre><pre class="alt">
 </pre><pre>
        g.DrawString(brush.Color.ToString, Font, Brushes.Black, e.Bounds.X + 30, e.Bounds.Y + 3)</pre><pre class="alt">
    <span class="kwrd">End</span> <span class="kwrd">Sub</span></pre><pre><span class="kwrd">End</span> <span class="kwrd">Class</span></pre></div></div><p /><style type="text/css"><![CDATA[

.csharpcode, .csharpcode pre
{
	font-size: small;
	color: black;
	font-family: consolas, "Courier New", courier, monospace;
	background-color: #ffffff;
	/*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
	background-color: #f4f4f4;
	width: 100%;
	margin: 0em;
}
.csharpcode .lnum { color: #606060; }]]></style><p> </p><p>執行畫面</p><p><img style="border-right-width: 0px; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" border="0" alt="image" width="300" height="169" src="\images\posts\8827\image_thumb_1.png" /></p>