---
layout: post
title: "Why i cache property value in method"
date: 2014-12-02 23:14
comments: true
categories: 
keywords: 
description: "Why i cache property value in method"
---

最近跟同事合作開發，同事看了我的程式後不解的問我為什麼在撰寫方法時都會把物件的成員屬性先存在區域變數再使用，當下跟他稍微的解釋了一下，為防以後要解釋相同的問題，這邊也稍微就所想到的隨手做個紀錄。 

<!--More-->

<br/>

其實這樣的撰寫方式，應該算是個人的一個小小開發習慣，好像並沒有一份文件對此有明確的定義與規範。  

<br/>


之所以會這麼撰寫，主要是基於下列這些因素...  

<br/>


我們都知道屬性底層是用 get 跟 set Method 去實作，頻繁叫用勢必會有儲存呼叫堆疊、區域變數、返回位置等 Overhead。這時適時的用區域變數將資料快取，最起碼我們能免去不必要的耗費。 

<br/>


另外就是在使用屬性時真的能清楚的知道屬性在實作時做了什麼嗎？如果自己實作的屬性，可能可以完全掌控，但難保在多人開發的情況下隨著案子的進行，裡面的實作不會跟著走樣，更何況有時我們用的是第三方套件內物件的屬性。在屬性的實作不能掌控的狀況下，不必要的多次叫用就變得很危險，如果實作不好，我們的程式就會有效能 Issue。所以我們需要適時的用區域變數將資料快取以求自保。 

<br/>


最後就是在多執行緒的開發上，屬性在實作上可能會針對存取做些 Lock，這時適時的用區域變數將資料快取，能有助於將存取的碰撞降至最低。 

<br/>


當然這邊也不是說什麼屬性資料都會用區域變數下去做快取，實際開發還是要視情況而定，基本上個人目前是以超過一次以上的存取，且快取後不影響可讀性為原則下去拿捏。
