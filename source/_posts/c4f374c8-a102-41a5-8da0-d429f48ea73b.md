---
layout: post
title: "[C#]如何修正MDI父視窗受子視窗影響而無法正常關閉的問題"
date: 2013-11-06 12:00:00
comments: true
categories: 
description: "[C#]如何修正MDI父視窗受子視窗影響而無法正常關閉的問題"
---
<p>昨天有讀者在筆者[VB.NET]MDI子視窗清單的實作</a>這篇反應用筆者的程式讓MDI的父視窗無法正常關閉，筆者覺得很不可思議，因為筆者的程式只有替換掉內建的MDI子視窗清單，並在點選時將對應的子視窗帶上來，不怎麼可能造成視窗無法關閉的情況，就算影響也應該只影響子視窗才是，因為筆者並未動到父視窗的部分。因此用Visual Studio內建的MDI樣板來做試驗。</p>  <p> </p>  <p>實際照著步驟測試，先點開兩個子視窗。</p>  <p><a href="http://files.dotblogs.com.tw/larrynung/1301/CMDI_BBFB/image_2.png"><img style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px" border="0" alt="image" src="\images\posts\c4f374c8-a102-41a5-8da0-d429f48ea73b\image_thumb.png" width="652" height="461" /></a> </p>  <p> </p>  <p>將最上面的子視窗縮小。</p>  <p><a href="http://files.dotblogs.com.tw/larrynung/1301/CMDI_BBFB/image_4.png"><img style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px" border="0" alt="image" src="\images\posts\c4f374c8-a102-41a5-8da0-d429f48ea73b\image_thumb_1.png" width="652" height="461" /></a> </p>  <p> </p>  <p>然後把未縮小的子視窗給關閉。</p>  <p><a href="http://files.dotblogs.com.tw/larrynung/1301/CMDI_BBFB/image_6.png"><img style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px" border="0" alt="image" src="\images\posts\c4f374c8-a102-41a5-8da0-d429f48ea73b\image_thumb_2.png" width="652" height="461" /></a> </p>  <p> </p>  <p>這時候按下MDI父視窗右上角的關閉按鈕，發現的確是無法正常退出，按下去完全沒有反應。追了一下發現MDI父視窗不知道怎麼回事在FormClosing觸發時就已經將cancel設為true了。</p>  <p><a href="http://files.dotblogs.com.tw/larrynung/1301/CMDI_BBFB/image_10.png"><img style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px" border="0" alt="image" src="\images\posts\c4f374c8-a102-41a5-8da0-d429f48ea73b\image_thumb_4.png" width="631" height="72" /> </p>  <p> </p>  <p>若碰到這個問題，開發人員可自行將cancel設回false來避開。</p>  <div id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:fd4d1f83-9c4d-4690-a48a-176c7891c4b1" class="wlWriterSmartContent" style="float: none; padding-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px"><pre name="code" class="c#">        private void MDIParent1_FormClosing(object sender, FormClosingEventArgs e)
        {
            e.Cancel = false;
        }</pre></div>