---
layout: post
title: "[Visual Studio]Visual Studio 2010 New Feature - DataTips"
date: 2010-03-15 06:08:11
comments: true
tags: [Visual Studio]
description: "[Visual Studio]Visual Studio 2010 New Feature - DataTips"
---
<p>VS2010在DataTips上也做了些改進，像是允許我們把DataTips給釘在相關的程式上、或是匯入匯出DataTips等。</p>  <p> </p>  <h2>Pin DataTips</h2>  <p>要把DataTips給釘在程式相關的程式中，我們可以在除錯運行被中斷的狀態，把滑鼠移到要觀看的變數上面，然後在浮現的DataTips後方，點選圖釘圖示。</p>  <p> <img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="\images\posts\14029\image74_thumb.png" width="478" height="57" /></a> </p>  <p> </p>  <p>或是直接在程式碼的變數上按右鍵，點選[Pin To Source]。</p>  <p><a href="http://files.dotblogs.com.tw/larrynung/1003/VisualStudioVisualStudio2010NewFeatureDa_896B/image32.png"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="\images\posts\14029\image32_thumb.png" width="488" height="278" /></a> </p>  <p> </p>  <p>DataTips釘住後，可以看到程式碼前方會出現圖釘圖示，後方的DataTips會用浮動的狀態持續的顯示。</p>  <p><a href="http://files.dotblogs.com.tw/larrynung/1003/VisualStudioVisualStudio2010NewFeatureDa_896B/image78.png"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="\images\posts\14029\image78_thumb.png" width="644" height="23" /></a> </p>  <p> </p>  <p>重複上述動作，我們可以在同一行程式加入多個DataTips浮動框 。</p>  <p><a href="http://files.dotblogs.com.tw/larrynung/1003/VisualStudioVisualStudio2010NewFeatureDa_896B/image_12.png"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="\images\posts\14029\image_thumb.png" width="644" height="28" /></a> </p>  <p> </p>  <p>此外，我們也可以在已開啟的DataTips浮動框上，按下滑鼠右鍵，點選[Add Expression]。</p>  <p><a href="http://files.dotblogs.com.tw/larrynung/1003/VisualStudioVisualStudio2010NewFeatureDa_896B/image_24.png"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="\images\posts\14029\image_thumb_5.png" width="422" height="209" /></a> </p>  <p> </p>  <p>輸入要加入的DataTips Expression，就可以把多個DataTips加到同一個DataTips浮動框。</p>  <p><a href="http://files.dotblogs.com.tw/larrynung/1003/VisualStudioVisualStudio2010NewFeatureDa_896B/image_26.png"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="\images\posts\14029\image_thumb_6.png" width="424" height="46" /></a></p>  <p><a href="http://files.dotblogs.com.tw/larrynung/1003/VisualStudioVisualStudio2010NewFeatureDa_896B/image_42.png"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="\images\posts\14029\image_thumb_10.png" width="442" height="48" /></a> </p>  <p> </p>  <p>若是不小心在錯誤的位置釘上了DataTips，可以直接用滑鼠拖曳著上下移動，DataTips浮動框會隨著拖曳變更釘住的位置。</p>  <p><a href="http://files.dotblogs.com.tw/larrynung/1003/VisualStudioVisualStudio2010NewFeatureDa_896B/image_50.png"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="\images\posts\14029\image_thumb_12.png" width="560" height="111" /></a> </p>  <p> </p>  <p>在除錯狀態停止後，DataTips浮動框會消失不見，前方的圖釘圖示仍會持續顯示。當把滑鼠游標移至前方的圖釘圖示，DataTips浮動框會浮現出來，順帶會顯示上次除錯的狀態。</p>  <p> <a href="http://files.dotblogs.com.tw/larrynung/1003/VisualStudioVisualStudio2010NewFeatureDa_896B/image_48.png"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="\images\posts\14029\image_thumb_11.png" width="644" height="69" /></a> </p>  <p> </p>  <h2>Set DataTips Comment</h2>  <p>若是有要注意或要提示的事宜想要標註，VS2010也允許我們為DataTips加入對應的註解，只要把滑鼠移至DataTips浮動框上方，在浮現出來的控制列上，選取最下方的按鈕把Comments展開。</p>  <p> <a href="http://files.dotblogs.com.tw/larrynung/1003/VisualStudioVisualStudio2010NewFeatureDa_896B/image_52.png"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="\images\posts\14029\image_thumb_20.png" width="308" height="93" /></a></p>  <p> </p>  <p>在展開的Comments欄位中，鍵入DataTips對應的註解即可。</p>  <p><a href="http://files.dotblogs.com.tw/larrynung/1003/VisualStudioVisualStudio2010NewFeatureDa_896B/image_54.png"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="\images\posts\14029\image_thumb_23.png" width="240" height="84" /></a> </p>  <p><a href="http://files.dotblogs.com.tw/larrynung/1003/VisualStudioVisualStudio2010NewFeatureDa_896B/image_56.png"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="\images\posts\14029\image_thumb_24.png" width="215" height="86" /></a> </p>  <p> </p>  <p>若後來覺得DataTips註解礙眼，也可以透過點選同樣的控制列按鈕，把DataTips註解摺疊隱藏。</p>  <p> </p>  <h2>Arrange DataTips</h2>  <p>VS2010的DataTips也支援排列的功能，若某行的DataTips被擺放的很凌亂，影響到程式的閱讀，我們可以透過VS2010的DataTips排列功能，做自動的排列整理。</p>  <p><a href="http://files.dotblogs.com.tw/larrynung/1003/VisualStudioVisualStudio2010NewFeatureDa_896B/image_64.png"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="\images\posts\14029\image_thumb_28.png" width="423" height="86" /></a> </p>  <p> </p>  <p>只要在程式碼前方的圖釘圖示按下滑鼠右鍵，在彈出的快顯選單中，點選Arrange。</p>  <p><a href="http://files.dotblogs.com.tw/larrynung/1003/VisualStudioVisualStudio2010NewFeatureDa_896B/image_66.png"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="\images\posts\14029\image_thumb_29.png" width="170" height="74" /></a> </p>  <p> </p>  <p>該行的DataTips就會被自動排列整理。</p>  <p><a href="http://files.dotblogs.com.tw/larrynung/1003/VisualStudioVisualStudio2010NewFeatureDa_896B/image_68.png"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="\images\posts\14029\image_thumb_30.png" width="593" height="99" /></a> </p>  <p>  </p>  <h2>UnPin DataTips</h2>  <p>DataTips在VS2010除了可以釘在相關的程式碼外，也可以不跟程式碼綁住，而是像便利貼一樣隨處擺放。只要把滑鼠移至釘住的DataTips浮動框，選取中間的控制列按鈕，把DataTips浮動框的圖釘給拔起。</p>  <p><a href="http://files.dotblogs.com.tw/larrynung/1003/VisualStudioVisualStudio2010NewFeatureDa_896B/image_58.png"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="\images\posts\14029\image_thumb_25.png" width="331" height="90" /></a> </p>  <p> </p>  <p>DataTips浮動框就會變得像是便利貼一樣，就像是一個Memo，而與程式無直接對應的關係。</p>  <p><a href="http://files.dotblogs.com.tw/larrynung/1003/VisualStudioVisualStudio2010NewFeatureDa_896B/image_60.png"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="\images\posts\14029\image_thumb_26.png" width="453" height="80" /></a> </p>  <p>  </p>  <h2>Clear DataTips</h2>  <p>可以增加DataTips，自然也可以移除不用的DataTips。在DataTips的移除上，可以一次移除全部，也可以只移除特定的DataTips。</p>  <p> </p>  <p>在移除全部上，我們可以透過滑鼠點選[Debug]→[Clear All DataTips]，把專案中所有的DataTips給移除。</p>  <p><a href="http://files.dotblogs.com.tw/larrynung/1003/VisualStudioVisualStudio2010NewFeatureDa_896B/image12.png"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="\images\posts\14029\image12_thumb.png" width="394" height="442" /></a></p>  <p> </p>  <p>或是透過滑鼠點選[Debug]→[Clear All DataTips Pinned to Form1.cs]，把檔案中所有的DataTips給移除。</p>  <p><a href="http://files.dotblogs.com.tw/larrynung/1003/VisualStudioVisualStudio2010NewFeatureDa_896B/image16.png"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="\images\posts\14029\image16_thumb.png" width="394" height="442" /></a> </p>  <p> </p>  <p>而在移除指定的DataTips上，可在除錯運行的狀態下，透過DataTips浮動框工具列上的Close按鈕。</p>  <p><a href="http://files.dotblogs.com.tw/larrynung/1003/VisualStudioVisualStudio2010NewFeatureDa_896B/image_70.png"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="\images\posts\14029\image_thumb_31.png" width="209" height="65" /></a> </p>  <p> </p>  <p>或是在程式碼前方的圖釘圖示上按下滑鼠右鍵，點選Clear，來清除指定的DataTips。</p>  <p><a href="http://files.dotblogs.com.tw/larrynung/1003/VisualStudioVisualStudio2010NewFeatureDa_896B/image26.png"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="\images\posts\14029\image26_thumb.png" width="164" height="94" /></a> </p>  <p><a href="http://files.dotblogs.com.tw/larrynung/1003/VisualStudioVisualStudio2010NewFeatureDa_896B/image_62.png"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="\images\posts\14029\image_thumb_27.png" width="601" height="73" /></a> </p>  <p> </p>  <h2> </h2>  <h2>Import/Export DataTips</h2>  <p>DataTips也支援匯出與匯入的動作。若要匯出DataTips，可透過滑鼠點選[Debug]→[Export DataTips…]，把專案中的DataTips給匯出成Xml檔。</p>  <p><a href="http://files.dotblogs.com.tw/larrynung/1003/VisualStudioVisualStudio2010NewFeatureDa_896B/image4.png"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="\images\posts\14029\image4_thumb.png" width="392" height="444" /></a> </p>  <p> </p>  <p>匯入時，可透過滑鼠點選[Debug]→[Import DataTips…]，把之前匯出的Xml檔給匯入進來。</p>  <p><a href="http://files.dotblogs.com.tw/larrynung/1003/VisualStudioVisualStudio2010NewFeatureDa_896B/image8.png"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="\images\posts\14029\image8_thumb.png" width="394" height="441" /></a> </p>  <p> </p>  <p>值得注意的是，DataTips的匯入與匯出動作看起來跟BreakPoint的處理一樣，只看檔名與行數，因此使用上必須確保檔案是一致的，不然可能會造成DataTips的位置不正確的情況，或是造成錯誤的發生。</p>  <p> </p>  <h2>Link</h2>  <ul>   <li><a href="http://www.dotblogs.com.tw/lolota/archive/2010/01/31/13424.aspx" target="_blank">[VS2010 Online]在VS2010中的筆記本 – DataTips 以及 BreakPoint 新功能介紹</a> </li>    <li><a href="http://blogs.msdn.com/zainnab/archive/2010/02/02/pin-a-datatip-to-source-vstipdebug0005.aspx" target="_blank">PIN A DATATIP TO SOURCE – VSTIPDEBUG0005</a> </li>    <li><a href="http://blogs.msdn.com/zainnab/archive/2010/03/03/clearing-your-datatips-vstipdebug0014.aspx" target="_blank">CLEARING YOUR DATATIPS – VSTIPDEBUG0014</a> </li>    <li><a href="http://blogs.msdn.com/zainnab/archive/2010/03/02/import-and-export-datatips-vstipdebug0013.aspx" target="_blank">IMPORT AND EXPORT DATATIPS</a> </li>    <li><a href="http://blogs.msdn.com/zainnab/archive/2010/02/26/datatip-value-from-the-last-debug-session-vstipdebug0012.aspx" target="_blank">DATATIP VALUE FROM THE LAST DEBUG SESSION</a> </li>    <li><a href="http://blogs.msdn.com/zainnab/archive/2010/02/04/adding-comments-to-a-datatip-vstipdebug0007.aspx" target="_blank">ADDING COMMENTS TO A DATATIP – VSTIPDEBUG0007</a> </li>    <li><a href="http://blogs.msdn.com/zainnab/archive/2010/02/03/create-a-floating-datatip-vstipdebug0006.aspx" target="_blank">CREATE A FLOATING DATATIP -- VSTIPDEBUG0006 </li> </ul>