---
layout: post
title: "[Performance]Set Form's Position"
date: 2009-12-30 10:56:13
comments: true
categories: [Performance]
description: "[Performance]Set Form's Position"
---
<p>今天看網路文章時，注意到指定表單位置的方法。一般來說我們碰到這個問題，可以直接建立一個Point，並指派給Form.Location。或是直接指派Form.Top與Form.Left兩個表單屬性。很無聊的我又測了一下兩者的效能差異。</p>  <p> </p>  <p>測試UI如下：</p>  <p><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="\images\posts\12741\image_thumb.png" width="194" height="115" /></p>  <p> </p>  <p>測試程式碼如下：</p>  <div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:cc2aba92-85e8-4e88-a2e9-395d4f17babb" class="wlWriterEditableSmartContent"><pre name="code" class="vb:nocontrols">Public Class Form1

    Dim _f As New Form
    Private Sub btnSetByPoint_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnSetByPoint.Click
        _f.Show()
        Dim sw As Stopwatch = Stopwatch.StartNew
        For i As Integer = 0 To NumericUpDown1.Value
            _f.Location = New Point(10, 10)
        Next
        sw.Stop()
        _f.Hide()
        MsgBox("SetByPoint: " &amp; sw.ElapsedMilliseconds.ToString)
    End Sub

    Private Sub btnSetByProperty_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnSetByProperty.Click
        _f.Show()
        Dim sw As Stopwatch = Stopwatch.StartNew
        For i As Integer = 0 To NumericUpDown1.Value
            _f.Top = 10
            _f.Left = 10
        Next
        sw.Stop()
        _f.Hide()
        MsgBox("SetByProperty: " &amp; sw.ElapsedMilliseconds.ToString)
    End Sub

End Class
</pre></div>

<p> </p>

<p>測試結果如下：</p>

<p>當測試次數為10000時</p>

<p><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="\images\posts\12741\image_thumb_10.png" width="185" height="158" /></a> <a href="http://files.dotblogs.com.tw/larrynung/0912/Performance_136E7/image_24.png" rel="lightbox"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="\images\posts\12741\image_thumb_11.png" width="185" height="158" /> </p>

<p> </p>

<p>當測試次數為100000時</p>

<p><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="\images\posts\12741\image_thumb_14.png" width="185" height="158" /></a> <a href="http://files.dotblogs.com.tw/larrynung/0912/Performance_136E7/image_28.png" rel="lightbox"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="\images\posts\12741\image_thumb_13.png" width="185" height="158" /> </p>

<p />

<p />

<p />

<p />

<p />

<p />

<p />

<p />

<p />

<p />

<p />

<p />

<p />

<p />

<p />

<p> </p>

<p>當測試次數為1000000時</p>

<p><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="\images\posts\12741\image_thumb_15.png" width="185" height="158" /></a> <a href="http://files.dotblogs.com.tw/larrynung/0912/Performance_136E7/image_34.png" rel="lightbox"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="\images\posts\12741\image_thumb_16.png" width="185" height="158" /> </p>

<p> </p>

<p>當測試次數為10000000時</p>

<p><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="\images\posts\12741\image_thumb_17.png" width="185" height="158" /></a> <a href="http://files.dotblogs.com.tw/larrynung/0912/Performance_136E7/image_38.png" rel="lightbox"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="\images\posts\12741\image_thumb_18.png" width="185" height="158" /> </p>

<p> </p>

<p>統計一下測試結果</p>

<p><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="\images\posts\12741\image_thumb_1.png" width="487" height="295" /> </p>

<p>依以上的測試，我們可以看到直接指定Location會比透過屬性設定表單位置來得有效率。</p>