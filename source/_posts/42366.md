---
layout: post
title: "[C++]C++ Nativated Property Code Snippet"
date: 2011-10-13 12:39:34
comments: true
categories: [C++]
description: "[C++]C++ Nativated Property Code Snippet"
---
<p>
	Visual Studio 2011 Preview開始支援C++的Code Snippet，開發人員可以將自己常用的功能寫成Code Snippet加速專案的開發。由於筆者在開發Nativated C++時，常會需要撰寫Nativated Property，故將其整理為Code Snippet，Code Snippet內容如下：</p>
<div class="wlWriterSmartContent" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:fdc711ff-8a41-4fc0-ac5c-f2eca34ebc83" style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px">
	<pre class="xml" name="code">
&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;CodeSnippets xmlns="http://schemas.microsoft.com/VisualStudio/2005/CodeSnippet"&gt;
  &lt;CodeSnippet Format="1.0.0"&gt;
    &lt;Header&gt;
      &lt;Title&gt;Nativated Property&lt;/Title&gt;
      &lt;Shortcut&gt;nprop&lt;/Shortcut&gt;      
      &lt;Description&gt;Nativated Property&lt;/Description&gt;
      &lt;Author&gt;Larry Nung&lt;/Author&gt;
      &lt;SnippetTypes&gt;
				&lt;SnippetType&gt;Expansion&lt;/SnippetType&gt;
      &lt;/SnippetTypes&gt;      
    &lt;/Header&gt;
    &lt;Snippet&gt;     
      &lt;Declarations&gt;
	&lt;Literal&gt;
	  &lt;ID&gt;type&lt;/ID&gt;
	  &lt;ToolTip&gt;Type of property&lt;/ToolTip&gt;
	  &lt;Default&gt;int&lt;/Default&gt;
	&lt;/Literal&gt;
        &lt;Literal Editable="true"&gt;
          &lt;ID&gt;field&lt;/ID&gt;
          &lt;Type&gt;&lt;/Type&gt;
          &lt;ToolTip&gt;&lt;/ToolTip&gt;
          &lt;Default&gt;nValue&lt;/Default&gt;
          &lt;Function&gt;&lt;/Function&gt;
        &lt;/Literal&gt;
      &lt;/Declarations&gt;
      &lt;Code Language="Cpp"&gt;&lt;![CDATA[#pragma region Var
private:
	$type$ _$field$;
#pragma endregion


#pragma region Public  Property
public:
	__declspec(property(get=Get_$field$,put=Set_$field$))
		$type$ m_$field$;
#pragma endregion


#pragma region Property Process Method
public:
	inline $type$ Get_$field$()
	{
		return _$field$;
	}

	inline void Set_$field$($type$ value)
	{
		if(_$field$ == value)
			return;

		_$field$ = value;
	}
#pragma endregion]]&gt;&lt;/Code&gt;
    &lt;/Snippet&gt;
  &lt;/CodeSnippet&gt;
&lt;/CodeSnippets&gt;</pre>
</div>
<p>
	 </p>
<p>
	將其複製下來存至 [My Documents]\Visual Studio 11\Code Snippets\Visual C++\My Code Snippets 下，副檔名為snippet。</p>
<p>
	<img alt="image" border="0" height="394" src="\images\posts\42366\image_thumb_1.png" style="border-right-width: 0px; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" width="523" /></p>
<p>
	 </p>
<p>
	放置好後可叫出Code Snippets Manager查看。</p>
<p>
	<img alt="image" border="0" height="455" src="\images\posts\42366\image_thumb_3.png" style="border-right-width: 0px; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" width="384" /></p>
<p>
	 </p>
<p>
	剛剛手動加入的Code Snippet應該可在Code Snippets Manager看到。</p>
<p>
	<img alt="image" border="0" height="502" src="\images\posts\42366\image_thumb_5.png" style="border-right-width: 0px; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" width="633" /></p>
<p>
	 </p>
<p>
	使用上在編譯視窗內輸入nprop，連按兩次[Tab]按鍵。</p>
<p>
	<img alt="image" border="0" height="202" src="\images\posts\42366\image_thumb_2.png" style="border-right-width: 0px; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" width="537" /></p>
<p>
	 </p>
<p>
	Nativated Property的程式碼片斷就會輸入到編輯區中，再針對屬性的型態、屬性的名稱做些調整就可以了。</p>
<p>
	<img alt="image" border="0" height="458" src="\images\posts\42366\image_thumb_4.png" style="border-right-width: 0px; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" width="430" /></p>
