---
layout: post
title: "[VB.NET]自定義.NET WindowForm表單介面(三)"
date: 2010-04-23 12:11:15
comments: true
categories: [VB.NET]
description: "[VB.NET]自定義.NET WindowForm表單介面(三)"
---
<p>繼之前談到的自定義WindowForm表單介面(二)，裡面提到的方法一與方法二在使用上都會有個現象，那就是在工作列上按下滑鼠右鍵，本來該彈出的快顯選單消失不見了。</p>  <p><img border="0" alt="image" src="\images\posts\14759\image_thumb.png" width="187" height="53" /></p>  <p> </p>  <p>其實這個問題可以透過GetWindowLong把視窗目前的Style值取出，加上系統選單與縮小的Style，再用SetWindowLong把視窗Style設起來。程式如下：</p>  <div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:ef3c571c-5f03-412c-88ac-703a1f129675" class="wlWriterEditableSmartContent"><pre name="code" class="vb">    &lt;DllImport("user32.dll", SetLastError:=True)&gt; _
Private Shared Function GetWindowLong( _
     ByVal hWnd As IntPtr, _
     ByVal nIndex As Integer) As Integer
    End Function

    &lt;DllImport("user32.dll", SetLastError:=True)&gt; _
Private Shared Function SetWindowLong(ByVal hWnd As IntPtr, ByVal nIndex As Integer, ByVal dwNewLong As Integer) As Integer
    End Function

    Public Const WS_SYSMENU As Integer = &amp;H80000
    Const WS_MINIMIZEBOX As Integer = &amp;H20000

    Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
        Dim winLong As Integer = GetWindowLong(New HandleRef(Me, Me.Handle), -16)
        SetWindowLong(New HandleRef(Me, Me.Handle), -16, winLong Or WS_SYSMENU Or WS_MINIMIZEBOX)
    End Sub</pre></div>

<p> </p>

<p>運行後在工作列上的圖示按滑鼠右鍵，就會發現消失的快顯選單被恢復了。</p>

<p><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="\images\posts\14759\image_thumb.png" width="397" height="468" /></p>