---
layout: post
title: "[VB.NET]列舉型別字串處理的注意事項"
date: 2009-09-01 09:00:33
comments: true
tags: [VB.NET]
description: "[VB.NET]列舉型別字串處理的注意事項"
---
<p>不知道大家是否有發現，列舉型別在做字串處理時，會因寫法不同而有所差異。</p><p>舉個例子來看，假設我們寫了一個SexType的列舉</p><div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:3524b009-959b-467c-82b7-e68cb57f2941" class="wlWriterEditableSmartContent"><pre class="vb:nocontrols" name="code">
   Enum SexType As Integer
        Boy
        Girl
    End Enum</pre></div><p> </p><p>並做了如下的字串處理： <br /> </p><div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:4b9c8ef2-c667-408a-bf77-d93ea26ba939" class="wlWriterEditableSmartContent"><pre class="vb:nocontrols" name="code">
        Dim sex As SexType = SexType.Boy
        Console.WriteLine("Sex: " &amp; sex.ToString &amp; " (" &amp; sex &amp; ")")</pre></div><p> </p><p> </p><p>後面未加ToString()的在編譯後會先被轉型成Int後才轉型為String。<img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" width="504" height="93" src="\images\posts\10348\image_thumb_2.png" /></a></p><p> </p><p>運行結果 <br /><a rel="lightbox" href="http://files.dotblogs.com.tw/larrynung/0909/bc5e868eed93_13493/image_4.png"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" width="504" height="181" src="\images\posts\10348\image_thumb_1.png" /></p><p> </p><p>若換個寫法 <br /> </p><div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:8a578592-b799-48e4-8be5-81604464bfce" class="wlWriterEditableSmartContent"><pre class="vb:nocontrols" name="code">
        Dim sex As SexType = SexType.Boy
        Console.WriteLine(String.Format("Sex: {0} ({1})", sex, CInt(sex)))</pre></div><p> </p><p> </p><p>運行後結果跟上面的一樣，因此我們可發現透過String.Format來處理，列舉型別就不會先轉為int再轉為String。</p><p> </p><p>再做個實驗看看，當我們把列舉值直接秀出 <br /> </p><div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:f181b859-5dc1-4e89-a026-ed90ae7495d4" class="wlWriterEditableSmartContent"><pre class="vb:nocontrols" name="code">
        Dim sex As SexType = SexType.Boy
        Console.WriteLine(sex)</pre></div><p> </p><p> </p><p>編譯後程式還是會先被轉換成Int <br /><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" width="484" height="111" src="\images\posts\10348\image_thumb_4.png" /></a></p><p> </p><p>運行結果 <br /><a rel="lightbox" href="http://files.dotblogs.com.tw/larrynung/0909/bc5e868eed93_13493/image_8.png"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" width="504" height="137" src="\images\posts\10348\image_thumb_3.png" /></p><p> </p><p>若是先把列舉值塞到Object型別再顯示 <br /> </p><div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:04f3e9ef-2e22-4a7d-820a-5b4f7fed759f" class="wlWriterEditableSmartContent"><pre class="vb:nocontrols" name="code">
        Dim sex As SexType = SexType.Boy
        Dim sexObj As Object = sex
        Console.WriteLine(sexObj)</pre></div><p> </p><p> </p><p>運行結果 <br /><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" width="504" height="138" src="\images\posts\10348\image_thumb_5.png" /> </p><p> </p><p>由以上實驗可以看出，當把列舉值直接當字串顯示時，會先轉成Int後再顯示。但當把列舉值塞到Object顯示，則會直接顯示而不會先轉成Int。</p><p> </p><p>完整範例 <br /> </p><div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:c13262cf-e3aa-429a-b553-5bb3ed793b49" class="wlWriterEditableSmartContent"><pre class="vb:nocontrols" name="code">
Module Module1
    Enum SexType As Integer
        Boy
        Girl
    End Enum

    Sub Main()
        Dim msg As String
        Dim sex As SexType = SexType.Boy
        msg = "Sex: " &amp; sex.ToString &amp; " (" &amp; sex &amp; ")"
        Console.WriteLine(msg)

        msg = String.Format("Sex: {0} ({1})", sex, CInt(sex))
        Console.WriteLine(msg)
    End Sub
End Module
</pre></div><p> </p><p> </p><p> </p><p>執行結果 <br /><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" width="504" height="173" src="\images\posts\10348\image_thumb.png" /></p>