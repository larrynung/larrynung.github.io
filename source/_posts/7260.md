---
layout: post
title: "[.NET Concept][VB.NET]字串 = Nothing V.S 字串 is Nothing"
date: 2009-02-22 06:56:04
comments: true
tags: [.NET Concept,VB.NET]
description: "[.NET Concept][VB.NET]字串 = Nothing V.S 字串 is Nothing"
---
<p>今天回答網友問題時，由於一時筆誤，把本來要寫『字串 is Nothing』的地方錯打成『字串 = Nothing』，造成程式怎麼看就是看不出哪裡邏輯有問題，最後才注意到這邊打錯。</p><p>發現後覺得很神奇，因為我一直以為寫成『字串 = Nothing』會編譯錯誤的，沒想到它竟然能過。但也由於它能過的關係，導致找了半天找不到問題所在。而問題就在於若是使用『字串 is Nothing』來判斷的話，須要字串的值真的是Nothing才會成立。而使用『字串 = Nothing』來判斷的話，則判斷時會把Nothing與String.Empty視為相等，因此就算是字串為空字串該判斷條件也會成立。</p><p>簡單的示意範例如下:</p><div class="csharpcode"><div class="csharpcode"><pre class="alt"><span class="kwrd">Public</span> <span class="kwrd">Class</span> Form1</pre><pre>
 </pre><pre class="alt">
    <span class="kwrd">Private</span> <span class="kwrd">Sub</span> Form1_Load(<span class="kwrd">ByVal</span> sender <span class="kwrd">As</span> System.<span class="kwrd">Object</span>, <span class="kwrd">ByVal</span> e <span class="kwrd">As</span> System.EventArgs) <span class="kwrd">Handles</span> <span class="kwrd">MyBase</span>.Load</pre><pre>
        MsgBox(IsStringNothing1(<span class="str">""</span>))</pre><pre class="alt">
        MsgBox(IsStringNothing2(<span class="str">""</span>))</pre><pre>
    <span class="kwrd">End</span> <span class="kwrd">Sub</span></pre><pre class="alt">
 </pre><pre>
    <span class="kwrd">Private</span> <span class="kwrd">Function</span> IsStringNothing1(<span class="kwrd">ByVal</span> str <span class="kwrd">As</span> <span class="kwrd">String</span>) <span class="kwrd">As</span> <span class="kwrd">Boolean</span></pre><pre class="alt">
        <span class="kwrd">Return</span> str = <span class="kwrd">Nothing</span></pre><pre>
    <span class="kwrd">End</span> <span class="kwrd">Function</span></pre><pre class="alt">
 </pre><pre>
    <span class="kwrd">Private</span> <span class="kwrd">Function</span> IsStringNothing2(<span class="kwrd">ByVal</span> str <span class="kwrd">As</span> <span class="kwrd">String</span>) <span class="kwrd">As</span> <span class="kwrd">Boolean</span></pre><pre class="alt">
        <span class="kwrd">Return</span> str <span class="kwrd">Is</span> <span class="kwrd">Nothing</span></pre><pre>
    <span class="kwrd">End</span> <span class="kwrd">Function</span></pre><pre class="alt"><span class="kwrd">End</span> Class</pre></div><style type="text/css"><![CDATA[
.csharpcode, .csharpcode pre
{
	font-size: small;
	color: black;
	font-family: consolas, "Courier New", courier, monospace;
	background-color: #ffffff;
	/*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
	background-color: #f4f4f4;
	width: 100%;
	margin: 0em;
}
.csharpcode .lnum { color: #606060; }]]></style></div>