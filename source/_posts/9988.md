---
layout: post
title: "[VB.NET]VB 10.0 Auto-Implemented Properties"
date: 2009-08-11 08:59:53
comments: true
categories: [VB.NET]
description: "[VB.NET]VB 10.0 Auto-Implemented Properties"
---
<h2>Introduction</h2><p>Auto-Implemented Properties是VB.NET 10.0的特色之一。讓我們在撰寫屬性時只需短短一行即可，其細部的私有欄位與Get、Set區塊都將由編譯器在編譯時幫我們自動產生。可簡化屬性的撰寫，加速程式撰寫速度。</p><p> </p><h2>Support</h2><ul><li>VB 10.0 or latter</li></ul><p> </p><h2>Auto-Implemented Properties</h2><p>在以往我們要建立一個屬性時，我們通常會建立個私有欄位用來儲存屬性的值。並會利用Property關鍵字設定屬性區塊，在Get、Set區塊撰寫取值與設值的程式碼。就像是下面這樣：</p><div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:3ecbd329-1c1b-43e7-9a56-a186752d5a41" class="wlWriterEditableSmartContent"><pre class="vb:nocontrols" name="code">
    Private _name As String

    Property Name As String
        Get
            Return _name
        End Get
        Set(ByVal value As String)
            _name = value
        End Set
    End Property</pre></div><p> </p><p>透過VB.NET 10.0的Auto-Implemented Properties功能，我們可以將屬性的撰寫給簡化。像是上面的例子可簡化為像下面這樣：</p><div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:636f2abe-f420-46bd-a9e4-5ced6d93ac70" class="wlWriterEditableSmartContent"><pre class="vb:nocontrols" name="code">
Property Name As String</pre></div><p> </p><p>短短的一行就可以取代本來冗長的程式，是不是很方便呢？除此之外，Auto-Implemented Properties也可以利用變數初始器來設定屬性的預設值。就像：</p><div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:541a9856-06d0-4c04-8e37-0119ea87bf9f" class="wlWriterEditableSmartContent"><pre class="vb:nocontrols" name="code">
Property Name As String = "Larry"</pre></div><p> </p><p>若是使用較為複雜的型別也可以</p><div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:a600102c-8ebb-4371-bf00-0843208c5600" class="wlWriterEditableSmartContent"><pre class="vb:nocontrols" name="code">
Property SupplierList() As New List(Of Supplier)
Property OrderList() As New List(Of Order) With {.Capacity = 100}
</pre></div><p> </p><p>也可以用在介面屬性的實作上</p><div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:2a172ea7-b36b-4005-8926-2fc416ed010b" class="wlWriterEditableSmartContent"><pre class="vb:nocontrols" name="code">
Property Name() As String Implements ICustomer.Name</pre></div><p> </p><h2>注意事項</h2><p><strong>1.不支援ReadOnly關鍵字</strong></p><p>若在Auto-Implemented Properties前面加上ReadOnly關鍵字</p><div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:1501bd7c-506f-4a7a-83d2-b9f8c86daf47" class="wlWriterEditableSmartContent"><pre class="vb:nocontrols" name="code">
ReadOnly Property Name() As String</pre></div><p> </p><p>則編譯器會顯示錯誤</p><p><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" width="372" height="34" src="\images\posts\9988\image_thumb_3.png" /></p><p> </p><p> </p><p><strong>2.不支援WriteOnly關鍵字</strong></p><p>若在Auto-Implemented Properties前面加上WriteOnly關鍵字</p><div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:58827aa5-93b8-4a75-8c55-98f6a7fe44a7" class="wlWriterEditableSmartContent"><pre class="vb:nocontrols" name="code">
WriteOnly Property Name() As String</pre></div><p> </p><p>則編譯器會顯示錯誤</p><p> <img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" width="375" height="38" src="\images\posts\9988\image_thumb_4.png" /></p><p> </p><p><strong>3.不支援帶參數的屬性</strong></p><p>若在Auto-Implemented Properties設定參數</p><div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:f70d6db2-af88-4ac3-b026-a7a72e50a24a" class="wlWriterEditableSmartContent"><pre class="vb:nocontrols" name="code">
Property Items(ByVal idx As Integer) As String</pre></div><p> </p><p>則編譯器會顯示錯誤</p><p><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" width="359" height="47" src="\images\posts\9988\image_thumb_1.png" /></p><p> </p><p><strong>4.不支援索引器</strong></p><p>由於無法支援帶參數的屬性，自然無法支援索引器。</p>