---
layout: post
title: "[Extension Method][VB.NET]使用擴充方法過濾出組件內的特定類別"
date: 2010-04-16 12:16:19
comments: true
tags: [VB.NET]
description: "[Extension Method][VB.NET]使用擴充方法過濾出組件內的特定類別"
---
<p>今天把之前的[C#][VB.NET]取得專案內所有表單名稱這篇程式給修了一下，順便把其概念提出成擴充方法，整理如下：</p>  <p />  <div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:f94df2b5-45e7-42be-b42c-138b55cb815c" class="wlWriterEditableSmartContent"><pre name="code" class="vb">Imports System.Reflection
Imports System.Runtime.CompilerServices

Module AssembleExtension
    &lt;Extension()&gt; _
    Public Function GetTypes(ByVal asm As Assembly, ByVal filterTypeName As String, Optional ByVal includeSubClass As Boolean = False) As Type()
        Return GetTypes(asm, Type.GetType(filterTypeName), includeSubClass)
    End Function

    &lt;Extension()&gt; _
    Public Function GetTypes(ByVal asm As Assembly, ByVal filterType As Type, Optional ByVal includeSubClass As Boolean = False) As Type()
        Dim linq = From t In asm.GetTypes Where t Is filterType OrElse (includeSubClass AndAlso t.IsSubclassOf(filterType)) Select t
        Return linq.ToArray
    End Function
End Module
</pre></div>

<p />

<p> </p>

<p>使用上取得Assembly物件後，呼叫GetTypes，並傳入要過濾的型態等參數，即可取得過濾完的類型。</p>

<p> </p>

<p>舉個例子來看，假設還是要取得專案中所有表單的話，程式可以簡化成下面這樣：</p>

<div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:d2998abf-631c-4bc5-869e-c7a4862d384c" class="wlWriterEditableSmartContent"><pre name="code" class="vb:nocontrols">Dim formTypes() as Type = Assembly.GetExecutingAssembly.GetTypes(GetType(Form), True)       </pre></div>