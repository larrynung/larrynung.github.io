---
layout: post
title: ".NET 4.0 New Feature - 程式碼合約(Code Contracts) (四) Contract.ForAll &amp; Contract.Exists"
date: 2010-09-20 05:32:47
comments: true
tags: [CSharp]
description: ".NET 4.0 New Feature - 程式碼合約(Code Contracts) (四) Contract.ForAll &amp; Contract.Exists"
---
<p>
	為了方便處理集合類型變數的合約驗證，Code Contracts貼心的提供了Contract.ForAll與Contract.Exists兩個輔助用的合約方法，可與前置條件或後置條件搭配使用。</p>
<p>
	 </p>
<h2>
	Contract.ForAll</h2>
<p>
	Contract.ForAll合約方法可用來判斷集合內部的所有項目是否皆滿足所要驗證的條件，其運作規則如下：</p>
<ul>
	<li>
		集合內任何元素帶入運算為False=&gt;ForAll動作停止，回傳False</li>
	<li>
		集合內所有元素帶入運算皆為True=&gt;回傳True</li>
</ul>
<p>
	 </p>
<p>
	撰寫時可用Contract.ForAll方法表示，主要有下列兩個多載函式：</p>
<p>
	<img alt="clip_image001" border="0" height="125" src="\images\posts\17822\clip_image001_thumb.png" style="border-bottom: 0px; border-left: 0px; border-top: 0px; border-right: 0px" width="583" /></p>
<p>
	 </p>
<p>
	使用上可直接對其帶入集合物件與要驗證的條件，像是要驗證集合內部所內含的項目是否皆不為空，我們就可以撰寫如下驗證程式：</p>
<div class="wlWriterSmartContent" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:f395dad6-2e16-47f8-a9d9-a8320f243717" style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px">
	<pre class="c#" name="code">
public int Foo&lt;T&gt;(IEnumerable&lt;T&gt; xs){
    Contract.Requires(Contract. ForAll (xs , x =&gt; x != null) );
}

</pre>
</div>
<p>
	 </p>
<p>
	而若只想驗證集合內的某一區間，不想驗證集合內所有項目時，可考慮利用另一多載方法帶入所要驗證的區間範圍，像是：</p>
<div class="wlWriterSmartContent" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:5541cee8-5bd8-486f-9893-3a2aa6e81938" style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px">
	<pre class="c#" name="code">
public int Foo&lt;T&gt;(T[] xs){
    Contract. Requires ( Contract. ForAll (0,xs.Length,
index =&gt; xs[index] != null));
}

</pre>
</div>
<p>
	 </p>
<h2>
	Contract.Exists</h2>
<p>
	Contract.Exists合約方法是用來判斷集合內的項目是否有符合驗證條件的項目，其運作規則如下：</p>
<ul>
	<li>
		集合內任何元素帶入運算為True=&gt;Exists動作停止，回傳True</li>
	<li>
		集合內所有元素帶入運算皆為False=&gt;回傳False</li>
</ul>
<p>
	 </p>
<p>
	撰寫時可用 Contract.Exists方法表示，該方法與Contract.ForAll合約一樣有兩個多載函式：</p>
<p>
	<img alt="clip_image002" border="0" height="125" src="\images\posts\17822\clip_image002_thumb.png" style="border-bottom: 0px; border-left: 0px; border-top: 0px; border-right: 0px" width="583" /></p>
<p>
	 </p>
<p>
	使用上也十分的類似</p>
<div class="wlWriterSmartContent" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:fcd7edec-f3ab-452d-94ba-33d6666cc57c" style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px">
	<pre class="c#" name="code">
public int Foo&lt;T&gt;(IEnumerable&lt;T&gt; xs){
    Contract.Requires(Contract. Exists(xs , x =&gt; x != null) );
}
</pre>
</div>
<p>
	 </p>
<h2>
	Link</h2>
<ul>
	<li>
		Contract.ForAll 方法</li>
	<li>
		Contract.Exists 方法</li>
</ul>
