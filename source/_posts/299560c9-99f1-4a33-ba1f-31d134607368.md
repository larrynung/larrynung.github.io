---
layout: post
title: ".NET 4.0 New Feature - Path.Combine"
date: 2013-11-06 12:00:00
comments: true
categories: 
description: ".NET 4.0 New Feature - Path.Combine"
---
<p>
	在.NET 4.0以前Path.Combine只能將兩個路徑合併，因此有時候我們在處理路徑時，若有多個路徑合併的需求，我們必須像下面這樣重覆叫用Path.Combine方法來達成這樣的功能：</p>
<div class="wlWriterSmartContent" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:afc63e72-12c5-4699-98b4-99e66f4cff15" style="padding-right: 0px; display: inline; padding-left: 0px; float: none; padding-bottom: 0px; margin: 0px; padding-top: 0px">
	<pre class="vb" name="code">
	Console.WriteLine(Path.Combine(Path.Combine("c:\123", "456"), "789"))</pre>
</div>
<p>
	 </p>
<p>
	或是自行撰寫個方法去做這樣的合併動作：</p>
<div class="wlWriterSmartContent" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:a66806b9-8ea6-4c5a-baa9-c27d55a4f9d8" style="padding-right: 0px; display: inline; padding-left: 0px; float: none; padding-bottom: 0px; margin: 0px; padding-top: 0px">
	<pre class="vb" name="code">
	Function CombinePathes(ByVal ParamArray pathes As String()) As String
        Dim combinedPath As String = pathes.FirstOrDefault
        For idx As Integer = 1 To pathes.Count - 1
            combinedPath = IO.Path.Combine(combinedPath, pathes(idx))
        Next
        Return combinedPath
    End Function</pre>
</div>
<p>
	 </p>
<p>
	在.NET 4.0以後，Path.Combine又多了三個多載函式，有允許傳入路徑字串陣列的、有傳入三個路徑去做合併的、也有傳入四個路徑去做合併的。</p>
<p>
	<img alt="image" border="0" height="147" src="\images\posts\299560c9-99f1-4a33-ba1f-31d134607368\image_thumb.png" style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" width="529" /></p>
<p>
	 </p>
<p>
	其中以傳入路徑字串陣列的多載版本最為重要，看起來可以Cover其它兩個多載版本，允許傳入任意個數的路徑去做合併，使用上非常簡單，這邊不多作解釋直接看下面的使用範例就可以了：</p>
<div class="wlWriterSmartContent" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:95e33c51-7ae2-415f-835c-e7289ec5de49" style="padding-right: 0px; display: inline; padding-left: 0px; float: none; padding-bottom: 0px; margin: 0px; padding-top: 0px">
	<pre class="vb" name="code">
	Console.WriteLine(Path.Combine("c:\123", "456", "789"))
Console.WriteLine(Path.Combine(New String() {"c:\123", "456", "789"}))
</pre>
</div>
<p>
	 </p>
<h2>
	Link</h2>
<ul>
	<li>
		Path.Combine 方法</li>
</ul>
