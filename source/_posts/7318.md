---
layout: post
title: "[C#][VB.NET]取得專案內所有表單名稱"
date: 2009-02-28 11:04:33
comments: true
tags: [VB.NET,C#]
description: "[C#][VB.NET]取得專案內所有表單名稱"
---
<p>前陣子在藍色小鋪衝浪時看到網友的詢問，問題的需求很奇妙，是想要能取得專案內所有的表單名稱。雖然直覺上就覺得.NET Framework內不會有對應的函式可以直接使用，為求保險仍是去試了一下，結果跟想的一樣，找不到能直接使用的函式。最後只好回到用.NET反射機制(Reflection)去達到該需求。</p><p>程式流程為：</p><ol><li>利用.NET反射機制取得目前組件</li><li>找尋組件內所有類別型態</li><li>判斷並列出繼承Form的類別</li></ol><p>簡單的範例Code如下：</p><p>VB.NET</p><div class="csharpcode"><pre class="alt"><span class="kwrd">Imports</span> System.Reflection</pre><pre>
 </pre><pre class="alt"><span class="kwrd">Public</span> <span class="kwrd">Class</span> Form1</pre><pre>
 </pre><pre class="alt">
    <span class="kwrd">Private</span> <span class="kwrd">Sub</span> Button1_Click(<span class="kwrd">ByVal</span> sender <span class="kwrd">As</span> System.<span class="kwrd">Object</span>, <span class="kwrd">ByVal</span> e <span class="kwrd">As</span> System.EventArgs) <span class="kwrd">Handles</span> Button1.Click</pre><pre>
        <span class="kwrd">Dim</span> a <span class="kwrd">As</span> <span class="kwrd">Assembly</span> = <span class="kwrd">Assembly</span>.GetExecutingAssembly       <span class="rem">'取得目前組件</span></pre><pre class="alt">
        <span class="kwrd">For</span> <span class="kwrd">Each</span> t <span class="kwrd">As</span> Type <span class="kwrd">In</span> a.GetTypes                        <span class="rem">'找尋組件內所有類別型態</span></pre><pre>
            <span class="kwrd">If</span> t.IsSubclassOf(<span class="kwrd">GetType</span>(Form)) <span class="kwrd">Then</span>                 <span class="rem">'如果類別是繼承自Form的話</span></pre><pre class="alt">
                TextBox1.AppendText(t.ToString &amp; vbNewLine)     <span class="rem">'列出該類別資訊</span></pre><pre>
            <span class="kwrd">End</span> <span class="kwrd">If</span></pre><pre class="alt">
        <span class="kwrd">Next</span></pre><pre>
    <span class="kwrd">End</span> <span class="kwrd">Sub</span></pre><pre class="alt"><span class="kwrd">End</span> Class</pre></div><p> </p><p> </p><p> </p><p /><style type="text/css"><![CDATA[
.csharpcode, .csharpcode pre
{
	font-size: small;
	color: black;
	font-family: consolas, "Courier New", courier, monospace;
	background-color: #ffffff;
	/*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
	background-color: #f4f4f4;
	width: 100%;
	margin: 0em;
}
.csharpcode .lnum { color: #606060; }]]></style><p>C#</p><div class="csharpcode"><pre class="alt"><span class="kwrd">using</span> System;</pre></div><div class="csharpcode"><pre><span class="kwrd">using</span> System.Collections.Generic;</pre></div><div class="csharpcode"><pre class="alt"><span class="kwrd">using</span> System.ComponentModel;</pre></div><div class="csharpcode"><pre><span class="kwrd">using</span> System.Data;</pre></div><div class="csharpcode"><pre class="alt"><span class="kwrd">using</span> System.Drawing;</pre></div><div class="csharpcode"><pre><span class="kwrd">using</span> System.Linq;</pre></div><div class="csharpcode"><pre class="alt"><span class="kwrd">using</span> System.Text;</pre></div><div class="csharpcode"><pre><span class="kwrd">using</span> System.Windows.Forms;</pre></div><div class="csharpcode"><pre class="alt"><span class="kwrd">using</span> System.Reflection;</pre></div><div class="csharpcode"><pre>
 </pre></div><div class="csharpcode"><pre class="alt"><span class="kwrd">namespace</span> WindowsFormsApplication1</pre></div><div class="csharpcode"><pre>
{</pre></div><div class="csharpcode"><pre class="alt">
    <span class="kwrd">public</span> <span class="kwrd">partial</span> <span class="kwrd">class</span> Form1 : Form</pre></div><div class="csharpcode"><pre>
    {</pre></div><div class="csharpcode"><pre class="alt">
        <span class="kwrd">public</span> Form1()</pre></div><div class="csharpcode"><pre>
        {</pre></div><div class="csharpcode"><pre class="alt">
            InitializeComponent();</pre></div><div class="csharpcode"><pre>
        }</pre></div><div class="csharpcode"><pre class="alt">
 </pre></div><div class="csharpcode"><pre>
        <span class="kwrd">private</span> <span class="kwrd">void</span> button1_Click(<span class="kwrd">object</span> sender, EventArgs e)</pre></div><div class="csharpcode"><pre class="alt">
        {</pre></div><div class="csharpcode"><pre>
            Assembly a = Assembly.GetExecutingAssembly();       <span class="rem">//取得目前組件</span></pre></div><div class="csharpcode"><pre class="alt">
            </pre></div><div class="csharpcode"><pre>
            <span class="kwrd">foreach</span> (Type t <span class="kwrd">in</span> a.GetTypes())                    <span class="rem">//找尋組件內所有類別型態</span></pre></div><div class="csharpcode"><pre class="alt">
            {</pre></div><div class="csharpcode"><pre>
                <span class="kwrd">if</span> (t.IsSubclassOf(<span class="kwrd">typeof</span>(Form)))           <span class="rem">//如果父類別是繼承自Form的話</span></pre></div><div class="csharpcode"><pre class="alt">
                {</pre></div><div class="csharpcode"><pre>
                    textBox1.AppendText(t.ToString() + <span class="str">"\r\n"</span>); <span class="rem">//列出該類別資訊</span></pre></div><div class="csharpcode"><pre class="alt">
                }</pre></div><div class="csharpcode"><pre>
            }</pre></div><div class="csharpcode"><pre class="alt">
 </pre></div><div class="csharpcode"><pre>
        }</pre></div><div class="csharpcode"><pre class="alt">
    }</pre></div><div class="csharpcode"><pre>
}</pre></div><div class="csharpcode"><pre>
 </pre><p>其主要概念就是利用.NET反射機制，找出目前檔案內所有繼承自Form類別的子類別而已。</p><p>特別提醒一下，.NET反射機制有著效能不好的問題，使用上能避免使用.NET反射機制就盡然避免使用。</p></div><div class="csharpcode"><pre>
 </pre></div><h2>參考連結</h2><div class="csharpcode"><ul><li>藍色小鋪 - 如何取的專案內所有表單名稱</li></ul></div><p> </p>