---
layout: post
title: "[VB.NET]取得Gif動畫圖檔內含的圖片"
date: 2010-01-24 12:31:09
comments: true
categories: [VB.NET]
description: "[VB.NET]取得Gif動畫圖檔內含的圖片"
---
<p>要取得Gif動畫圖檔內含的圖片，必須要了解的有Bitmap.FrameDimensionsList、FrameDimension Class、Bitmap.GetFrameCount、與Bitmap.SelectActiveFrame。</p>  <p> </p>  <p>實作上要先把Bitmap.FrameDimensionsList中第一個索引元素帶入FrameDimension建構函式，去建構FrameDimension物件。Bitmap.GetFrameCount帶入FrameDimension物件以取得動畫圖檔內含的圖片個數。再用Bitmap.SelectActiveFrame帶入FrameDimension物件與圖片索引設定當前圖片。像是：   <br />    </p><div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:db73bfb8-8f59-467d-ad11-87b1faeac2b0" class="wlWriterEditableSmartContent"><pre name="code" class="vb:nocontrols">    Private Function GetGifFrames(ByVal gifBmp As Bitmap) As Bitmap()
        Dim imgFrmDim As Imaging.FrameDimension = New Imaging.FrameDimension(gifBmp.FrameDimensionsList(0))
        Dim gifFrames(gifBmp.GetFrameCount(imgFrmDim) - 1) As Bitmap
        For photoIdx As Integer = 0 To gifFrames.Count - 1
            gifBmp.SelectActiveFrame(imgFrmDim, photoIdx)
            gifFrames(photoIdx) = New Bitmap(gifBmp)
        Next
        Return gifFrames
    End Function</pre></div>


<p> </p>

<p>範例介面 
  <br /><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="\images\posts\13254\image_thumb.png" width="359" height="250" /> </p>

<p> </p>

<p>範例程式 
  <br />

  </p><div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:d8cf0a48-addb-4127-807e-c14922305d70" class="wlWriterEditableSmartContent"><pre name="code" class="vb:nocontrols">Public Class Form1

    Private Sub btnFileBrowser_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnFileBrowser.Click
        If Me.OpenFileDialog1.ShowDialog = Windows.Forms.DialogResult.OK Then
            Me.tbxGifFile.Text = Me.OpenFileDialog1.FileName
            SplitGifFrame(New Bitmap(Me.tbxGifFile.Text))
        End If
    End Sub

    Private Sub SplitGifFrame(ByVal gifBmp As Bitmap)
        Me.flpGifFrames.Controls.Clear()
        Dim gifFrames() As Bitmap = GetGifFrames(gifBmp)
        flpGifFrames.SuspendLayout()
        For Each frame As Bitmap In gifFrames
            flpGifFrames.Controls.Add(New PictureBox With {.Image = frame})
        Next
        flpGifFrames.ResumeLayout()
        Me.tsslStatus.Text = My.Computer.FileSystem.GetName(Me.tbxGifFile.Text) &amp; " 內含 " &amp; gifFrames.Count.ToString &amp; " 個圖片"
    End Sub

    Private Function GetGifFrames(ByVal gifBmp As Bitmap) As Bitmap()
        Dim imgFrmDim As Imaging.FrameDimension = New Imaging.FrameDimension(gifBmp.FrameDimensionsList(0))
        Dim gifFrames(gifBmp.GetFrameCount(imgFrmDim) - 1) As Bitmap
        For photoIdx As Integer = 0 To gifFrames.Count - 1
            gifBmp.SelectActiveFrame(imgFrmDim, photoIdx)
            gifFrames(photoIdx) = New Bitmap(gifBmp)
        Next
        Return gifFrames
    End Function
End Class</pre></div>


<p />

<p> </p>

<p>運行結果 
  <br /><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="\images\posts\13254\image_thumb_1.png" width="457" height="299" /></p>