---
layout: post
title: "[C#][VB.NET]使用SystemInformation.PowerStatus查看目前電源使用狀態"
date: 2009-09-29 08:22:26
comments: true
categories: [C#]
description: "[C#][VB.NET]使用SystemInformation.PowerStatus查看目前電源使用狀態"
---
<h2>Introduction</h2>  <p>這篇簡單記錄一下，如何透過SystemInformation類別的PowerStatus屬性，來查看目前電源的使用狀態。</p>  <p> </p>  <h2>Namespace</h2>  <p>System.Windows.Forms</p>  <p> </p>  <h2>Assembly</h2>  <p>System.Windows.Forms (in System.Windows.Forms.dll) </p>  <p> </p>  <h2>Properties</h2>  <p>以下為PowerStatus類別所擁有的屬性(摘自MSDN Library)</p>  <table border="1" cellspacing="0" cellpadding="2" width="701"><tbody>     <tr>       <td valign="top" width="200">BatteryChargeStatus</td>        <td valign="top" width="499">Gets the current battery charge status.</td>     </tr>      <tr>       <td valign="top" width="200">BatteryFullLifetime</td>        <td valign="top" width="499">Gets the reported full charge lifetime of the primary battery power source in seconds.</td>     </tr>      <tr>       <td valign="top" width="200">BatteryLifePercent</td>        <td valign="top" width="499">Gets the approximate percentage of full battery time remaining.</td>     </tr>      <tr>       <td valign="top" width="200">BatteryLifeRemaining</td>        <td valign="top" width="499">Gets the approximate number of seconds of battery time remaining.</td>     </tr>      <tr>       <td valign="top" width="200">PowerLineStatus</td>        <td valign="top" width="499">Gets the current system power status.</td>     </tr>   </tbody></table>  <p> </p>  <p>MSDN上已經說明的很清楚了，這邊就只簡單的說明一下：</p>  <table border="1" cellspacing="0" cellpadding="2" width="701"><tbody>     <tr>       <td valign="top" width="200">BatteryChargeStatus</td>        <td valign="top" width="499">表示目前充電狀態。          <br />回傳值為BatteryChargeStatus型態的列舉值，其值可為High(高電量)、Low(低電量)、Critical(極低電量)、Charging(充電中)、NoSystemBattery(沒電池)、與Unknown(狀態不詳)。</td>     </tr>      <tr>       <td valign="top" width="200">BatteryFullLifetime</td>        <td valign="top" width="499">表示充滿電力可使用多久時間(-1為不詳)。</td>     </tr>      <tr>       <td valign="top" width="200">BatteryLifePercent</td>        <td valign="top" width="499">表示電力剩餘多少百分比(255為不詳)。</td>     </tr>      <tr>       <td valign="top" width="200">BatteryLifeRemaining</td>        <td valign="top" width="499">表示剩餘電力可使用多久時間(-1為不詳)。</td>     </tr>      <tr>       <td valign="top" width="200">PowerLineStatus</td>        <td valign="top" width="499">表示電源狀態。          <br />回傳值為PowerLineStatus型態的列舉值，其值可為Online(充電狀態)、Offline(電池模式)、與Unknow(狀態不詳)。</td>     </tr>   </tbody></table>  <p> </p>  <h2>Example</h2>  <p />  <p>C#    <br /></p>  <div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:1292710f-e5b1-46ab-8093-50df7304507d" class="wlWriterEditableSmartContent"><pre name="code" class="c#:nocontrols">namespace BatteryInfo
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }
        private void UpdateInfo()
        {
            PowerStatus ps = SystemInformation.PowerStatus;
            this.tbxPowerStatus.Text = ps.PowerLineStatus.ToString();
            this.tbxBatteryChargeStatus.Text = ps.BatteryChargeStatus.ToString();
            this.tbxBatteryFullLifetime.Text = ps.BatteryFullLifetime.ToString();
            this.tbxBatteryLifePercent.Text = ps.BatteryLifePercent.ToString();
            this.tbxBatteryLifeRemaining.Text = ps.BatteryLifeRemaining.ToString();
        }
        private void timer1_Tick(object sender, EventArgs e)
        {
            UpdateInfo();
        }
        private void Form1_Load(object sender, EventArgs e)
        {
            UpdateInfo();
        }        
    }
}</pre></div>

<p />

<p />

<p> </p>

<p>VB.NET  <br /></p>

<div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:2b865c7d-8156-422f-b572-31e067264dd5" class="wlWriterEditableSmartContent"><pre name="code" class="vb:nocontrols">Public Class Form1
    Private Sub UpdateInfo()
        Dim ps As PowerStatus = SystemInformation.PowerStatus
        With Me
            .tbxPowerStatus.Text = ps.PowerLineStatus.ToString
            .tbxBatteryChargeStatus.Text = ps.BatteryChargeStatus.ToString
            .tbxBatteryFullLifetime.Text = ps.BatteryFullLifetime
            .tbxBatteryLifePercent.Text = ps.BatteryLifePercent
            .tbxBatteryLifeRemaining.Text = ps.BatteryLifeRemaining
        End With
    End Sub
    Private Sub timer1_Tick(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles timer1.Tick
        UpdateInfo()
    End Sub
    Private Sub Form1_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
        UpdateInfo()
    End Sub
End Class
</pre></div>

<p />

<p> </p>

<p>執行畫面</p>

<p><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="\images\posts\10817\image_thumb.png" width="304" height="191" /></p>

<p> </p>

<h2>Link</h2>

<ul>
  <li>PowerStatus 類別</li>

  <li>PowerLineStatus 列舉型別</li>

  <li>BatteryChargeStatus 列舉型別</li>
</ul>