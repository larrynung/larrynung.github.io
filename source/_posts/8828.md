---
layout: post
title: "[VB.NET]ErrorProvider"
date: 2009-06-15 11:12:09
comments: true
categories: [VB.NET]
description: "[VB.NET]ErrorProvider"
---
<h2>Introduction</h2><p>ErrorProvider為Visual Studio所內建的控制項，主要功能是用以顯示錯誤訊息，提示錯誤發生。</p><p> </p><h2>重要成員</h2><p><strong>屬性</strong></p><p><img style="border-right-width: 0px; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" border="0" alt="image" width="657" height="80" src="\images\posts\8828\image_thumb.png" /></a></p><p> </p><p><strong>方法</strong></p><p><a href="http://files.dotblogs.com.tw/larrynung/0906/ErrorProvider_1510A/image_4.png"><img style="border-right-width: 0px; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" border="0" alt="image" width="665" height="28" src="\images\posts\8828\image_thumb_1.png" /></a></p><p> </p><p>其中BlinkStyle所用到的ErrorBlinkStyle列舉型別如下：</p><p><a href="http://files.dotblogs.com.tw/larrynung/0906/ErrorProvider_1510A/image_6.png"><img style="border-right-width: 0px; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" border="0" alt="image" width="691" height="240" src="\images\posts\8828\image_thumb_2.png" /></a></p><p> </p><h2>使用ErrorProvider</h2><p>ErrorProvider是個很簡單的控制項，基本上只需要了解SetError的用法即可。</p><p>讓我們先看一下MSDN的用法</p><p><a href="http://files.dotblogs.com.tw/larrynung/0906/ErrorProvider_1510A/image_8.png"><img style="border-right-width: 0px; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" border="0" alt="image" width="673" height="269" src="\images\posts\8828\image_thumb_3.png" /></a></p><p><a href="http://files.dotblogs.com.tw/larrynung/0906/ErrorProvider_1510A/image_10.png"><img style="border-right-width: 0px; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" border="0" alt="image" width="276" height="153" src="\images\posts\8828\image_thumb_4.png" /></a></p><p>MSDN上已把用法寫的很明顯了，就是傳入兩個參數，一個是有錯誤的控制項、一個就是錯誤的描述字串，在此就不再贅述。讓我們直接來看範例。</p><p> </p><p>假設今天我要做一個只能輸入數字的介面</p><p><a href="http://files.dotblogs.com.tw/larrynung/0906/ErrorProvider_1510A/image_12.png"><img style="border-right-width: 0px; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" border="0" alt="image" width="304" height="203" src="\images\posts\8828\image_thumb_5.png" /></a> </p><p> </p><p>當使用者輸入的值不為數字時，介面將提示使用者鍵入數字。</p><p><a href="http://files.dotblogs.com.tw/larrynung/0906/ErrorProvider_1510A/image_16.png"><img style="border-right-width: 0px; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" border="0" alt="image" width="304" height="203" src="\images\posts\8828\image_thumb_7.png" /> </p><p> </p><p>在程式編寫時只需在Validated事件內用ErrorProvider.SetError設定錯誤訊息即可。</p><div style="width: 610px; height: 173px; overflow: auto"><div class="csharpcode"><pre class="alt"><span class="kwrd">Public</span> <span class="kwrd">Class</span> Form1</pre><pre>
 </pre><pre class="alt">
    <span class="kwrd">Private</span> <span class="kwrd">Sub</span> TextBox1_Validated(<span class="kwrd">ByVal</span> sender <span class="kwrd">As</span> System.<span class="kwrd">Object</span>, <span class="kwrd">ByVal</span> e <span class="kwrd">As</span> System.EventArgs) <span class="kwrd">Handles</span> TextBox3.Validated, TextBox2.Validated, TextBox1.Validated</pre><pre>
        <span class="kwrd">Dim</span> ctrl <span class="kwrd">As</span> Control = <span class="kwrd">DirectCast</span>(sender, Control)</pre><pre class="alt">
        ErrorProvider1.SetError(ctrl, <span class="kwrd">If</span>(IsNumeric(ctrl.Text), <span class="str">""</span>, <span class="str">"此欄位只接受數字"</span>))</pre><pre>
    <span class="kwrd">End</span> <span class="kwrd">Sub</span></pre><pre class="alt"><span class="kwrd">End</span> <span class="kwrd">Class</span></pre></div></div><p> </p><p>程式流程如下：</p><p><img style="border-right-width: 0px; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" border="0" alt="image" width="228" height="237" src="\images\posts\8828\image_thumb_8.png" /></p><p> </p><p /><style type="text/css"><![CDATA[

.csharpcode, .csharpcode pre
{
	font-size: small;
	color: black;
	font-family: consolas, "Courier New", courier, monospace;
	background-color: #ffffff;
	/*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
	background-color: #f4f4f4;
	width: 100%;
	margin: 0em;
}
.csharpcode .lnum { color: #606060; }]]></style><style type="text/css"><![CDATA[

.csharpcode, .csharpcode pre
{
	font-size: small;
	color: black;
	font-family: consolas, "Courier New", courier, monospace;
	background-color: #ffffff;
	/*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
	background-color: #f4f4f4;
	width: 100%;
	margin: 0em;
}
.csharpcode .lnum { color: #606060; }]]></style><p> </p><h2>ErrorProvider的運用</h2><p>除了上面介紹的正規使用方式外。有時我們在撰寫介面時，我們會希望當介面上的資料有任意錯誤發生，則不讓使用者關閉、或是彈出確認視窗。通常一般的作法可能會透過Flag另外去記錄資訊，藉此判別是否有錯誤的資料。其實透過ErrorProvider我們可以很容易很方便的達到這需求。</p><p> </p><p>程式碼如下：</p><div style="width: 618px; height: 325px; overflow: auto"><div class="csharpcode"><pre class="alt"><span class="kwrd">Public</span> <span class="kwrd">Class</span> Form1</pre><pre>
 </pre><pre class="alt">
    <span class="kwrd">Private</span> <span class="kwrd">Sub</span> TextBox1_Validated(<span class="kwrd">ByVal</span> sender <span class="kwrd">As</span> System.<span class="kwrd">Object</span>, <span class="kwrd">ByVal</span> e <span class="kwrd">As</span> System.EventArgs) <span class="kwrd">Handles</span> TextBox3.Validated, TextBox2.Validated, TextBox1.Validated</pre><pre>
        <span class="kwrd">Dim</span> ctrl <span class="kwrd">As</span> Control = <span class="kwrd">DirectCast</span>(sender, Control)</pre><pre class="alt">
        ErrorProvider1.SetError(ctrl, <span class="kwrd">If</span>(IsNumeric(ctrl.Text), <span class="str">""</span>, <span class="str">"此欄位只接受數字"</span>))</pre><pre>
    <span class="kwrd">End</span> <span class="kwrd">Sub</span></pre><pre class="alt">
 </pre><pre>
    <span class="kwrd">Private</span> <span class="kwrd">Sub</span> Button1_Click(<span class="kwrd">ByVal</span> sender <span class="kwrd">As</span> System.<span class="kwrd">Object</span>, <span class="kwrd">ByVal</span> e <span class="kwrd">As</span> System.EventArgs) <span class="kwrd">Handles</span> Button1.Click</pre><pre class="alt">
        <span class="kwrd">If</span> IsError() <span class="kwrd">Then</span></pre><pre>
            <span class="kwrd">If</span> MsgBox(<span class="str">"部分設定有誤"</span>) = MsgBoxResult.Ok <span class="kwrd">Then</span></pre><pre class="alt">
                <span class="kwrd">Return</span></pre><pre>
            <span class="kwrd">End</span> <span class="kwrd">If</span></pre><pre class="alt">
        <span class="kwrd">End</span> <span class="kwrd">If</span></pre><pre>
        <span class="kwrd">Me</span>.Close()</pre><pre class="alt">
    <span class="kwrd">End</span> <span class="kwrd">Sub</span></pre><pre>
 </pre><pre class="alt">
    <span class="kwrd">Private</span> <span class="kwrd">Function</span> IsError() <span class="kwrd">As</span> <span class="kwrd">Boolean</span></pre><pre>
        <span class="kwrd">For</span> <span class="kwrd">Each</span> ctrl <span class="kwrd">As</span> Control <span class="kwrd">In</span> Controls</pre><pre class="alt">
            <span class="kwrd">If</span> ErrorProvider1.GetError(ctrl).Length &gt; 0 <span class="kwrd">Then</span></pre><pre>
                <span class="kwrd">Return</span> <span class="kwrd">True</span></pre><pre class="alt">
            <span class="kwrd">End</span> <span class="kwrd">If</span></pre><pre>
        <span class="kwrd">Next</span></pre><pre class="alt">
        <span class="kwrd">Return</span> <span class="kwrd">False</span></pre><pre>
    <span class="kwrd">End</span> <span class="kwrd">Function</span></pre><pre class="alt"><span class="kwrd">End</span> <span class="kwrd">Class</span></pre></div></div><p /><style type="text/css"><![CDATA[

.csharpcode, .csharpcode pre
{
	font-size: small;
	color: black;
	font-family: consolas, "Courier New", courier, monospace;
	background-color: #ffffff;
	/*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
	background-color: #f4f4f4;
	width: 100%;
	margin: 0em;
}
.csharpcode .lnum { color: #606060; }]]></style><style type="text/css"><![CDATA[

.csharpcode, .csharpcode pre
{
	font-size: small;
	color: black;
	font-family: consolas, "Courier New", courier, monospace;
	background-color: #ffffff;
	/*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
	background-color: #f4f4f4;
	width: 100%;
	margin: 0em;
}
.csharpcode .lnum { color: #606060; }]]></style><p> </p><p>執行畫面</p><p><img style="border-right-width: 0px; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" border="0" alt="image" width="301" height="199" src="\images\posts\8828\image_thumb_10.png" /></p>