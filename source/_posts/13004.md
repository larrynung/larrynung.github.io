---
layout: post
title: "[VB.NET]把.NET視窗嵌入.NET視窗或控制項"
date: 2010-01-13 11:36:59
comments: true
tags: [VB.NET]
description: "[VB.NET]把.NET視窗嵌入.NET視窗或控制項"
---
<p />  <p>前好一陣子看到同事在做抽換表單時，利用到了把視窗嵌入視窗或控制項的功能。這邊隨手記錄一下。</p>  <p> </p>  <p>要把視窗嵌入視窗，在表單的宣告上跟平常並無差異，只是多加了把TopLevel屬性設為False，則此表單即可嵌到另一個表單或控制項中。 </p>  <p> </p>  <p>TopLevel屬性主要是用來指出是否要將表單顯示為最上層視窗。最上層表單是沒有父表單的視窗，或它的父表單為桌面視窗。最上層視窗通常在應用程式中當做主表單使用。</p>  <p> </p>  <p>若未加入把TopLevel屬性設為False，則在表單嵌入時上會發生ArgumentException was unhandled的例外。<img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="\images\posts\13004\image_thumb.png" width="588" height="318" /></a> </p>  <p> </p>  <p>要把表單嵌入到另一個表單或控制項，主要操作步驟如下：</p>  <ol>   <li>宣告表單物件 </li>    <li>把表單物件的TopLevel屬性設為False </li>    <li>把表單嵌入另一個表單或控制項 </li> </ol>  <p><a href="http://files.dotblogs.com.tw/larrynung/1001/VB.NET_14701/image_12.png" rel="lightbox"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="\images\posts\13004\image_thumb_1.png" width="531" height="81" /> </p>  <p> </p>  <p>簡單的程式碼範例如下：    <br /></p>  <div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:5491ebc1-4092-4a78-8120-f27c58c98e00" class="wlWriterEditableSmartContent"><pre name="code" class="vb:nocontrols">        Dim f As New Form
        f.TopLevel = False
        f.Parent = Me
        f.Show()</pre></div>

<p />

<p />

<p> </p>

<p>嵌入的表單在使用上仍可以拖曳、縮小、放大、與關閉，操作就跟一般的視窗一樣，不同的只是它的活動範圍被限制在另一個視窗或控制項內。</p>

<p>若要用此方法來做抽換表單，可把視窗的FormBorderStyle設為None，並把它嵌到欲放置的控制項。</p>

<p> </p>

<h2>程式範例</h2>

<p>程式範例如下： 
  <br /></p>

<div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:01311fd0-8b14-49c3-87fa-bf9a65d7146d" class="wlWriterEditableSmartContent"><pre name="code" class="vb:nocontrols">Public Class Form1
    Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
        Dim f As New Form
        f.TopLevel = False
        f.Parent = Me
        f.Show()
    End Sub
End Class
</pre></div>

<p />

<p />

<p />

<p />

<p> </p>

<p>執行結果：</p>

<p><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="\images\posts\13004\image_thumb_2.png" width="304" height="304" /></a> <a href="http://files.dotblogs.com.tw/larrynung/1001/VB.NET_14701/image_10.png" rel="lightbox"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="\images\posts\13004\image_thumb_4.png" width="304" height="304" /></p>

<p> <img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="\images\posts\13004\image_thumb_7.png" width="304" height="304" /></a><a href="http://files.dotblogs.com.tw/larrynung/1001/VB.NET_14701/image_14.png" rel="lightbox"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="\images\posts\13004\image_thumb_6.png" width="304" height="304" /></p>

<p />

<p> </p>

<h2>Link</h2>

<ul>
  <li>Form.TopLevel 屬性 </li>
</ul>