---
layout: post
title: "[C#][VB.NET]使用AxMediaPlayer撥放多媒體"
date: 2009-02-28 03:41:58
comments: true
categories: [C#,VB.NET]
description: "[C#][VB.NET]使用AxMediaPlayer撥放多媒體"
---
<h2>加入工具箱</h2><p><strong>Step1.</strong>工具箱=&gt;滑鼠右鍵=&gt;選擇項目</p><p><img style="border-right-width: 0px; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" border="0" alt="image" width="214" height="460" src="\images\posts\7319\image_thumb_1.png" /></a> </p><p> </p><p><strong>Step2.</strong>切換至『COM 元件』頁籤並按下瀏覽鍵。</p><p><a href="http://files.dotblogs.com.tw/larrynung/0902/AxMediaPlayer_DC41/image_2.png"><img style="border-right-width: 0px; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" border="0" alt="image" width="575" height="380" src="\images\posts\7319\image_thumb.png" /></a> </p><p> </p><p><strong>Step3.</strong>找到Windows\System32下的msdxm.ocx檔後按下開啟鍵。</p><p><a href="http://files.dotblogs.com.tw/larrynung/0902/AxMediaPlayer_DC41/image_6.png"><img style="border-right-width: 0px; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" border="0" alt="image" width="567" height="394" src="\images\posts\7319\image_thumb_2.png" /></a> </p><p> </p><p><strong>Step4.</strong>會看到多了一個Windows Media Player的Com元件，此時勾選並按下確定鍵。</p><p><a href="http://files.dotblogs.com.tw/larrynung/0902/AxMediaPlayer_DC41/image_8.png"><img style="border-right-width: 0px; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" border="0" alt="image" width="575" height="380" src="\images\posts\7319\image_thumb_3.png" /></a> </p><p> </p><p><strong>Step5.</strong>會發現工具箱多了個Windows Media Player的控制項</p><p><a href="http://files.dotblogs.com.tw/larrynung/0902/AxMediaPlayer_DC41/image_12.png"><img style="border-right-width: 0px; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" border="0" alt="image" width="185" height="43" src="\images\posts\7319\image_thumb_5.png" /></a></p><p> </p><h2>使用AxMediaPlayer撥放多媒體</h2><p><strong>Step1.</strong>加入Windows Media Player控制項到設計表單，可看到如下的畫面。</p><p><a href="http://files.dotblogs.com.tw/larrynung/0902/AxMediaPlayer_DC41/image_14.png"><img style="border-right-width: 0px; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" border="0" alt="image" width="335" height="351" src="\images\posts\7319\image_thumb_6.png" /></a> </p><p> </p><p><strong>Step2.</strong>依序加入控制項使介面如下圖所示。</p><p><a href="http://files.dotblogs.com.tw/larrynung/0902/AxMediaPlayer_DC41/image_18.png"><img style="border-right-width: 0px; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" border="0" alt="image" width="335" height="439" src="\images\posts\7319\image_thumb_8.png" /> </p><p> </p><p><strong>Step3.</strong>撰寫控制項初始設定程式碼</p><p>此處是設定控制項的初始值，像是音量的最大值、最小值與目前的音量，值得注意的是AxMediaPlayer控制項的音量大小好像介於-10000~0之間，另外若不設定AutoStart = False則開啟檔案完程式就會自動撥放開啟的多媒體檔。</p><p>VB.NET</p><div style="width: 761px; height: 123px; overflow: auto"><div class="csharpcode"><pre class="alt">
    <span class="kwrd">Private</span> <span class="kwrd">Sub</span> Form1_Load(<span class="kwrd">ByVal</span> sender <span class="kwrd">As</span> System.<span class="kwrd">Object</span>, <span class="kwrd">ByVal</span> e <span class="kwrd">As</span> System.EventArgs) <span class="kwrd">Handles</span> <span class="kwrd">MyBase</span>.Load</pre><pre>
        <span class="kwrd">Me</span>.AxMediaPlayer1.AutoStart = <span class="kwrd">False</span>              <span class="rem">'設定不自動撥放</span></pre><pre class="alt">
        <span class="kwrd">Me</span>.tbarVolume.Minimum = -10000                    <span class="rem">'設定音量調整Bar最小值為最小音量值</span></pre><pre>
        <span class="kwrd">Me</span>.tbarVolume.Maximum = 0                         <span class="rem">'設定音量調整Bar最大值為最大音量值</span></pre><pre class="alt">
        <span class="kwrd">Me</span>.tbarVolume.Value = <span class="kwrd">Me</span>.AxMediaPlayer1.Volume    <span class="rem">'設定音量調整Bar目前值為目前音量值</span></pre><pre>
    <span class="kwrd">End</span> Sub</pre></div></div><p> </p><p>C#</p><div style="width: 759px; height: 142px; overflow: auto"><div class="csharpcode"><pre class="alt">
        <span class="kwrd">private</span> <span class="kwrd">void</span> Form1_Load(<span class="kwrd">object</span> sender, EventArgs e)</pre><pre>
        {</pre><pre class="alt">
            <span class="kwrd">this</span>.axMediaPlayer1.AutoStart = <span class="kwrd">false</span>;              <span class="rem">//設定不自動撥放</span></pre><pre>
            <span class="kwrd">this</span>.tbarVolume.Minimum = -10000;                   <span class="rem">//設定音量調整Bar最小值為最小音量值(-10000)</span></pre><pre class="alt">
            <span class="kwrd">this</span>.tbarVolume.Maximum = 0;                        <span class="rem">//設定音量調整Bar最大值為最大音量值(0)</span></pre><pre>
            <span class="kwrd">this</span>.tbarVolume.Value = <span class="kwrd">this</span>.axMediaPlayer1.Volume; <span class="rem">//設定音量調整Bar目前值為目前音量值</span></pre><pre class="alt">
        }</pre></div></div><p> </p><p><strong>Step4.</strong>撰寫開啟程式碼</p><p>AxMediaPlayer控制項的開啟可以直接設定FileName，亦可以使用Open函式。這邊除了開啟檔案外也需順道設定撥放位置的最大值與最小值。</p><p>VB.NET</p><div class="csharpcode"><div style="width: 769px; height: 155px; overflow: auto"><div class="csharpcode"><pre class="alt">
    <span class="kwrd">Private</span> <span class="kwrd">Sub</span> btnOpen_Click(<span class="kwrd">ByVal</span> sender <span class="kwrd">As</span> System.<span class="kwrd">Object</span>, <span class="kwrd">ByVal</span> e <span class="kwrd">As</span> System.EventArgs) <span class="kwrd">Handles</span> btnOpen.Click</pre><pre>
        <span class="kwrd">If</span> OpenFileDialog1.ShowDialog = Windows.Forms.DialogResult.OK <span class="kwrd">Then</span></pre><pre class="alt">
            <span class="rem">'Me.AxMediaPlayer1.Open(OpenFileDialog1.FileName)</span></pre><pre>
            <span class="kwrd">Me</span>.AxMediaPlayer1.FileName = OpenFileDialog1.FileName               <span class="rem">'開啟檔案</span></pre><pre class="alt">
            <span class="kwrd">Me</span>.tbarPlayLoaction.Minimum = <span class="kwrd">CInt</span>(<span class="kwrd">Me</span>.AxMediaPlayer1.SelectionStart)       <span class="rem">'設定撥放位置調整Bar最小值</span></pre><pre>
            <span class="kwrd">Me</span>.tbarPlayLoaction.Maximum = <span class="kwrd">CInt</span>(<span class="kwrd">Me</span>.AxMediaPlayer1.SelectionEnd)         <span class="rem">'設定撥放位置調整Bar最大值</span></pre><pre class="alt">
        <span class="kwrd">End</span> <span class="kwrd">If</span></pre><pre>
    <span class="kwrd">End</span> Sub</pre></div></div></div><p>  </p><p class="csharpcode">C#</p><div class="csharpcode"><div style="width: 768px; height: 170px; overflow: auto"><div class="csharpcode"><pre class="alt">
        <span class="kwrd">private</span> <span class="kwrd">void</span> btnOpen_Click(<span class="kwrd">object</span> sender, EventArgs e)</pre><pre>
        {</pre><pre class="alt">
            <span class="kwrd">if</span> (openFileDialog1.ShowDialog() == DialogResult.OK) {</pre><pre>
                <span class="rem">//this.axMediaPlayer1.Open(openFileDialog1.FileName);</span></pre><pre class="alt">
                <span class="kwrd">this</span>.axMediaPlayer1.FileName = openFileDialog1.FileName;                    <span class="rem">//開啟檔案</span></pre><pre>
                <span class="kwrd">this</span>.tbarPlayLoaction.Minimum = (<span class="kwrd">int</span>)<span class="kwrd">this</span>.axMediaPlayer1.SelectionStart;    <span class="rem">//設定撥放位置調整Bar最小值</span></pre><pre class="alt">
                <span class="kwrd">this</span>.tbarPlayLoaction.Maximum = (<span class="kwrd">int</span>)<span class="kwrd">this</span>.axMediaPlayer1.SelectionEnd;      <span class="rem">//設定撥放位置調整Bar最大值</span></pre><pre>
            }</pre><pre class="alt">
        }</pre></div></div></div><p> </p><p><strong>Step5.</strong>撰寫撥放程式碼</p><p>撰寫這部份功能程式碼只需呼叫AxMediaPlayer.Play()即可。</p><p>VB.NET</p><div style="width: 771px; height: 71px; overflow: auto"><div class="csharpcode"><pre class="alt">
    <span class="kwrd">Private</span> <span class="kwrd">Sub</span> btnPlay_Click(<span class="kwrd">ByVal</span> sender <span class="kwrd">As</span> System.<span class="kwrd">Object</span>, <span class="kwrd">ByVal</span> e <span class="kwrd">As</span> System.EventArgs) <span class="kwrd">Handles</span> btnPlay.Click</pre><pre>
        <span class="kwrd">Me</span>.AxMediaPlayer1.Play()        <span class="rem">'撥放</span></pre><pre class="alt">
    <span class="kwrd">End</span> Sub</pre></div></div><p> </p><p>C#</p><div style="width: 768px; height: 84px; overflow: auto"><div class="csharpcode"><pre class="alt">
        <span class="kwrd">private</span> <span class="kwrd">void</span> btnPlay_Click(<span class="kwrd">object</span> sender, EventArgs e)</pre><pre>
        {</pre><pre class="alt">
            <span class="kwrd">this</span>.axMediaPlayer1.Play();        <span class="rem">//撥放</span></pre><pre>
        }</pre></div></div><p>   </p><p> </p><p> </p><p /><style type="text/css"><![CDATA[




.csharpcode, .csharpcode pre
{
	font-size: small;
	color: black;
	font-family: consolas, "Courier New", courier, monospace;
	background-color: #ffffff;
	/*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
	background-color: #f4f4f4;
	width: 100%;
	margin: 0em;
}
.csharpcode .lnum { color: #606060; }]]></style><p><strong>Step6.</strong>撰寫停止程式碼</p><p>這邊需注意的是，AxMediaPlayer控制項的Stop函式雖然會停止撥放，但是停止後撥放位置仍維持在原位，因此當又按下撥放時，該控制項會從上次位置繼續撥放，有點類似暫停的功能(跟暫停的差異在於它會按下控制項上的Stop按鈕)，因此這邊須自行把撥放位置設回起始點。</p><p>VB.NET</p><div class="csharpcode"><div style="width: 778px; height: 87px; overflow: auto"><div class="csharpcode"><pre class="alt">
    <span class="kwrd">Private</span> <span class="kwrd">Sub</span> btnStop_Click(<span class="kwrd">ByVal</span> sender <span class="kwrd">As</span> System.<span class="kwrd">Object</span>, <span class="kwrd">ByVal</span> e <span class="kwrd">As</span> System.EventArgs) <span class="kwrd">Handles</span> btnStop.Click</pre><pre>
        <span class="kwrd">Me</span>.AxMediaPlayer1.<span class="kwrd">Stop</span>()                <span class="rem">'停止</span></pre><pre class="alt">
        AxMediaPlayer1.CurrentPosition = 0      <span class="rem">'把撥放位置設回起點</span></pre><pre>
    <span class="kwrd">End</span> Sub</pre></div></div></div><div class="csharpcode"> </div><p>C#</p><div style="width: 777px; height: 103px; overflow: auto"><div class="csharpcode"><pre class="alt">
        <span class="kwrd">private</span> <span class="kwrd">void</span> btnStop_Click(<span class="kwrd">object</span> sender, EventArgs e)</pre><pre>
        {</pre><pre class="alt">
            <span class="kwrd">this</span>.axMediaPlayer1.Stop();                     <span class="rem">//停止</span></pre><pre>
            <span class="kwrd">this</span>.axMediaPlayer1.CurrentPosition = 0;        <span class="rem">//把撥放位置設回起點</span></pre><pre class="alt">
        }</pre></div></div><p>  </p><p><strong>Step7.</strong>撰寫暫停撥放程式碼</p><p>撰寫這部份功能程式碼只需呼叫AxMediaPlayer.Pause()即可。</p><p>VB.NET</p><div style="width: 782px; height: 70px; overflow: auto"><div class="csharpcode"><pre class="alt">
    <span class="kwrd">Private</span> <span class="kwrd">Sub</span> btnPause_Click(<span class="kwrd">ByVal</span> sender <span class="kwrd">As</span> System.<span class="kwrd">Object</span>, <span class="kwrd">ByVal</span> e <span class="kwrd">As</span> System.EventArgs) <span class="kwrd">Handles</span> btnPause.Click</pre><pre>
        <span class="kwrd">Me</span>.AxMediaPlayer1.Pause()       <span class="rem">'暫停撥放</span></pre><pre class="alt">
    <span class="kwrd">End</span> Sub</pre></div></div><p> </p><p>C#</p><div style="width: 781px; height: 80px; overflow: auto"><div class="csharpcode"><pre class="alt">
        <span class="kwrd">private</span> <span class="kwrd">void</span> btnPause_Click(<span class="kwrd">object</span> sender, EventArgs e)</pre><pre>
        {</pre><pre class="alt">
            <span class="kwrd">this</span>.axMediaPlayer1.Pause();       <span class="rem">//暫停撥放</span></pre><pre>
        }</pre></div></div><p> </p><p><strong>Step8.</strong>撰寫音量控制程式碼</p><p>這部份功能程式碼只需對AxMediaPlayer.Volume做屬性值的變更即可。</p><p>VB.NET</p><div style="width: 789px; height: 214px; overflow: auto"><div class="csharpcode"><pre class="alt">
    <span class="kwrd">Private</span> <span class="kwrd">Sub</span> tbarVolume_Scroll(<span class="kwrd">ByVal</span> sender <span class="kwrd">As</span> System.<span class="kwrd">Object</span>, <span class="kwrd">ByVal</span> e <span class="kwrd">As</span> System.EventArgs) <span class="kwrd">Handles</span> tbarVolume.Scroll</pre><pre>
        <span class="kwrd">Me</span>.AxMediaPlayer1.Volume = tbarVolume.Value                     <span class="rem">'改變音量大小</span></pre><pre class="alt">
    <span class="kwrd">End</span> <span class="kwrd">Sub</span></pre><pre>
 </pre><pre class="alt">
    <span class="kwrd">Private</span> <span class="kwrd">Sub</span> btnIncreaseVolume_Click(<span class="kwrd">ByVal</span> sender <span class="kwrd">As</span> System.<span class="kwrd">Object</span>, <span class="kwrd">ByVal</span> e <span class="kwrd">As</span> System.EventArgs) <span class="kwrd">Handles</span> btnIncreaseVolume.Click</pre><pre>
        <span class="kwrd">Me</span>.AxMediaPlayer1.Volume += 1       <span class="rem">'音量大小+1</span></pre><pre class="alt">
    <span class="kwrd">End</span> <span class="kwrd">Sub</span></pre><pre>
 </pre><pre class="alt">
    <span class="kwrd">Private</span> <span class="kwrd">Sub</span> btnDecreaseVolume_Click(<span class="kwrd">ByVal</span> sender <span class="kwrd">As</span> System.<span class="kwrd">Object</span>, <span class="kwrd">ByVal</span> e <span class="kwrd">As</span> System.EventArgs) <span class="kwrd">Handles</span> btnDecreaseVolume.Click</pre><pre>
        <span class="kwrd">Me</span>.AxMediaPlayer1.Volume -= 1       <span class="rem">'音量大小-1</span></pre><pre class="alt">
    <span class="kwrd">End</span> Sub</pre></div></div><p> </p><p>C#</p><div style="width: 786px; height: 245px; overflow: auto"><div class="csharpcode"><pre class="alt">
        <span class="kwrd">private</span> <span class="kwrd">void</span> tbarVolume_Scroll(<span class="kwrd">object</span> sender, EventArgs e)</pre><pre>
        {</pre><pre class="alt">
            <span class="kwrd">this</span>.axMediaPlayer1.Volume = tbarVolume.Value;                     <span class="rem">//改變音量大小</span></pre><pre>
        }</pre><pre class="alt">
 </pre><pre>
        <span class="kwrd">private</span> <span class="kwrd">void</span> btnIncreaseVolume_Click(<span class="kwrd">object</span> sender, EventArgs e)</pre><pre class="alt">
        {</pre><pre>
            <span class="kwrd">this</span>.axMediaPlayer1.Volume += 1;       <span class="rem">//音量大小+1</span></pre><pre class="alt">
        }</pre><pre>
 </pre><pre class="alt">
        <span class="kwrd">private</span> <span class="kwrd">void</span> btnDecreaseVolume_Click(<span class="kwrd">object</span> sender, EventArgs e)</pre><pre>
        {</pre><pre class="alt">
            <span class="kwrd">this</span>.axMediaPlayer1.Volume -= 1;       <span class="rem">//音量大小-1</span></pre><pre>
        }</pre></div></div><p>  </p><p> <strong>Step9.</strong>撰寫撥放位置控制程式碼</p><p>這部份功能程式碼只需對AxMediaPlayer.CurrentPosition做屬性值的變更即可。</p><p>VB.NET</p><div style="width: 789px; height: 69px; overflow: auto"><div class="csharpcode"><pre class="alt">
    <span class="kwrd">Private</span> <span class="kwrd">Sub</span> tbarPlayLoaction_Scroll(<span class="kwrd">ByVal</span> sender <span class="kwrd">As</span> System.<span class="kwrd">Object</span>, <span class="kwrd">ByVal</span> e <span class="kwrd">As</span> System.EventArgs) <span class="kwrd">Handles</span> tbarPlayLoaction.Scroll</pre><pre>
        <span class="kwrd">Me</span>.AxMediaPlayer1.CurrentPosition = tbarPlayLoaction.Value          <span class="rem">'改變撥放位置</span></pre><pre class="alt">
    <span class="kwrd">End</span> Sub</pre></div></div><p> </p><p>C#</p><div style="width: 787px; height: 83px; overflow: auto"><div class="csharpcode"><pre class="alt">
        <span class="kwrd">private</span> <span class="kwrd">void</span> tbarPlayLoaction_Scroll(<span class="kwrd">object</span> sender, EventArgs e)</pre><pre>
        {</pre><pre class="alt">
            <span class="kwrd">this</span>.axMediaPlayer1.CurrentPosition = tbarPlayLoaction.Value;          <span class="rem">//改變撥放位置</span></pre><pre>
        }</pre></div></div><p> </p><h2>Download</h2><p>使用AxMediaPlayer撥放多媒體.zip</p><p> </p><p> </p><p> </p><p /><style type="text/css"><![CDATA[




.csharpcode, .csharpcode pre
{
	font-size: small;
	color: black;
	font-family: consolas, "Courier New", courier, monospace;
	background-color: #ffffff;
	/*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
	background-color: #f4f4f4;
	width: 100%;
	margin: 0em;
}
.csharpcode .lnum { color: #606060; }]]></style><style type="text/css"><![CDATA[




.csharpcode, .csharpcode pre
{
	font-size: small;
	color: black;
	font-family: consolas, "Courier New", courier, monospace;
	background-color: #ffffff;
	/*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
	background-color: #f4f4f4;
	width: 100%;
	margin: 0em;
}
.csharpcode .lnum { color: #606060; }]]></style><h2>參考連結</h2><ol><li>藍色小鋪 - media 播放設定問題</a></li><li><a target="_blank" href="http://support.microsoft.com/kb/821767/zh-tw">如何使用 Visual Basic.NET 或 Visual Basic 2005 中播放音訊檔案</li></ol><p> </p>