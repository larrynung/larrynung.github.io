---
layout: post
title: "使用C#呼叫VB.NET的CallByName函式"
date: 2010-11-19 12:17:23
comments: true
tags: [C#]
description: "使用C#呼叫VB.NET的CallByName函式"
---
<p>在VB.NET中有時會有要帶入方法名稱去執行對應方法，或是依屬性名稱去取得、設定其屬性值的需求，若不想使用麻煩的反射去處理，我們可以簡單的使用CallByName函式去達到這樣的需求。 </p>  <p> </p>  <p>若是在C#中想要使用VB.NET中的CallByName函式，我們可以將Microsoft.VisualBasic.dll加入參考。 </p>  <p><img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" height="368" alt="image" src="\images\posts\19554\image_thumb.png" width="506" border="0" /> </p>  <p> </p>  <p>並在程式碼上方加入Microsoft.VisualBasic與Microsoft.VisualBasic.CompilerServices這兩個命名空間 </p>  <div class="wlWriterSmartContent" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:83cd0057-46cf-468a-b0ab-25be2d4d1682" style="padding-right: 0px; display: inline; padding-left: 0px; float: none; padding-bottom: 0px; margin: 0px; padding-top: 0px"><pre name="code" class="c#">using Microsoft.VisualBasic;
using Microsoft.VisualBasic.CompilerServices;</pre></div>

<p> </p>

<p>就可以透過Versioned類別的CallByName方法使用VB.NET的CallByName函式，就像下面這樣：</p>

<div class="wlWriterSmartContent" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:e37c6301-5d27-48d5-adcc-88fd55358de1" style="padding-right: 0px; display: inline; padding-left: 0px; float: none; padding-bottom: 0px; margin: 0px; padding-top: 0px"><pre name="code" class="c#">using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using Microsoft.VisualBasic;
using Microsoft.VisualBasic.CompilerServices;
using System.Data;

namespace ConsoleApplication1
{
    class Program
    {
        static void Main(string[] args)
        {
            DataTable dt = new DataTable();
	    ...
            foreach (DataRow dr in dt.Rows)
            {
                foreach (DataColumn dc in dt.Columns)
                {
                    Versioned.CallByName(obj, dc.ColumnName, CallType.Set, dr(dc.ColumnName));
                }
            }
        }
    }
}</pre></div>