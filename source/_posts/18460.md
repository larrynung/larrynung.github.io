---
layout: post
title: "[VB.NET]使用Enum.Parse將數值或列舉型別常數名稱轉換成列舉型別物件"
date: 2010-10-19 11:25:07
comments: true
tags: [VB.NET]
description: "[VB.NET]使用Enum.Parse將數值或列舉型別常數名稱轉換成列舉型別物件"
---
<p>在研究列舉型別的新成員時，發現在 Enum.Parse中有些之前未注意到的地方，這邊將之整理一下。</p>  <p> </p>  <p>Enum.Parse具有兩個多載方法，兩個多載方法的差異只在於在轉換列舉型別物件時是否會依照大小寫的不同下去處理。</p>  <p><img style="border-right-width: 0px; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" border="0" alt="image" src="\images\posts\18460\image_thumb.png" width="562" height="145" /> </p>  <p> </p>  <p>在使用Enum.Parse轉換時，可以帶入的參數有列舉型別成員之基礎值或具名常數，或以逗號 (,) 分隔之具名常數清單的字串表示。</p>  <p> </p>  <p>以下面的列舉為例：</p>  <div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:696392e7-8237-4533-b019-3fc207e06046" class="wlWriterSmartContent"><pre name="code" class="vb">&lt;Flags()&gt; Enum Colors As Integer 
    None = 0 
    Red = 1 
    Green = 2 
    Blue = 4 
End Enum </pre></div>

<p> </p>

<p>我們可以像下面這般將數值轉換回列舉</p>

<div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:915d6784-9304-4d7e-82cd-08a84decbb32" class="wlWriterSmartContent"><pre name="code" class="vb">Dim value As String = "1"
Dim colorValue As Colors = CType([Enum].Parse(GetType(Colors), value), Colors) </pre></div>

<p> </p>

<p>把列舉型別常數名稱轉回列舉</p>

<div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:487d49e2-4355-43f1-b9e9-e01df334b006" class="wlWriterSmartContent"><pre name="code" class="vb">Dim value As String = "Red"
Dim colorValue As Colors = CType([Enum].Parse(GetType(Colors), value), Colors) </pre></div>

<p> </p>

<p>或是透過逗號串起的列舉型別常數名稱轉回列舉</p>

<div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:23464681-9dfc-4a72-bee1-046344840a29" class="wlWriterSmartContent"><pre name="code" class="vb">Dim value As String = String.Join(",", New Object() {"None", "Red", "Green"})
Dim colorValue As Colors = CType([Enum].Parse(GetType(Colors), value), Colors) </pre></div>

<p> </p>

<p>特別注意，由於要轉換的資料不一定能對應到列舉，有可能帶入不能轉換的資料，造成ArgumentException例外發生，因此必須使用例外處理包住，或是透過Enum.IsDefined先做判別處理。</p>

<p> </p>

<h2>Link</h2>

<ul>
  <li>Enum.Parse 方法 </li>
</ul>