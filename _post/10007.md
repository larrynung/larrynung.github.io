---
layout: post
title: "[VB.NET]VB 10.0 Array Literals"
date: 2009-08-12 09:03:57
comments: true
categories: [VB.NET]
description: "[VB.NET]VB 10.0 Array Literals"
---
<h2>Introduction</h2><p> </p><p>Array Literals功能簡單的說就是對區域型別推斷的加強，讓區域型別推斷能支援陣列型態。</p><p> </p><h2>Support</h2><ul><li>VB 10.0 or latter</li></ul><p> </p><h2>Array Literals</h2><p>在VB 9.0(含)以前，對於集合類別的區域型別推斷我們可以寫成如下這樣：</p><div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:8632877a-6e9c-44e9-bc1a-7191e7307c76" class="wlWriterEditableSmartContent"><pre class="vb:nocontrols" name="code">
Dim intAttay = New Integer() {1, 2, 3}</pre></div><p> </p><p>在VB 10.0以後我們可以更為簡化</p><div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:a11edab1-f032-41b7-b4e9-e5e5fc763185" class="wlWriterEditableSmartContent"><pre class="vb:nocontrols" name="code">
Dim intArray = {1, 2, 3}</pre></div><p> </p><p>編譯器會自動偵測等號右邊的型態，並用以設定等號左邊的變數型態</p><p> </p><div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:eef7f46d-0b1d-4c08-96b8-30af21112763" class="wlWriterEditableSmartContent"><pre class="vb:nocontrols" name="code">
    Dim a = {1, 2, 3}             'infers Integer()
    Dim b = {1, 2, 3.5}          'infers Double()
    Dim c = {"1", "2", "3"}     'infers String()
    Dim d = {1, "123"}          'infers Object() (warning with Option Strict On)
</pre></div><p> </p><p> </p><p>也可以用來設定多維陣列或是不規則陣列</p><div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:875e843c-d759-49c2-ac80-051427b1c23a" class="wlWriterEditableSmartContent"><pre class="vb:nocontrols" name="code">
    Dim e = {{1, 2, 3}, {4, 5, 6}}         'infers Integer(,)
    Dim f = {({1, 2, 3}), ({4, 5, 6})}     'infers Integer()() (jagged array)</pre></div>