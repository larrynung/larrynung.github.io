---
layout: post
title: "[VB.NET]VB 10.0 Collection Initializers"
date: 2009-08-12 09:03:35
comments: true
categories: [VB.NET]
description: "[VB.NET]VB 10.0 Collection Initializers"
---
<h2>Introduction</h2><p>Collection Initializers是VB.NET 10.0的特色之一，讓我們能在宣告集合物件的同時塞入集合成員資料。</p><p> </p><h2>Support</h2><ul><li>VB 10.0 or latter</li></ul><p> </p><h2>Collection Initializers</h2><p>在VB.NET 9.0(含)以前，當我們想宣告集合物件並塞入集合成員資料，我們必需先宣告集合物件，接著使用Add把集合成員資料塞入集合物件。</p><div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:f6976a4c-2e83-4e8a-b1b6-ae7011379a20" class="wlWriterEditableSmartContent"><pre class="vb:nocontrols" name="code">
        Dim list = New List(Of String)
        list.Add("abc")
        list.Add("def")
        list.Add("ghi")</pre></div><p> </p><p>或用AddRange塞入集合成員資料。</p><div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:24ef63ae-f172-4a32-9a2b-2cb660afeef3" class="wlWriterEditableSmartContent"><pre class="vb:nocontrols" name="code">
        Dim list = New List(Of String)
        list.AddRange(New String() {"abc", "def", "ghi"})</pre></div><p> </p><p>但在VB.NET 10.0(含)以後，我們可以透過From關鍵字來達到相同的目的。就像下面這樣：</p><div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:35cd9807-a03d-4972-a333-5716a1a8536f" class="wlWriterEditableSmartContent"><pre class="vb:nocontrols" name="code">
Dim list = New List(Of String) From {"abc", "def", "ghi"}</pre></div><p> </p><p>編譯器在編譯時會自動幫我們把程式拆解回本來用Add呼叫的樣子。同樣的，Dictionary類別也可以採用相同方式來初始化。</p><div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:3270cac5-cf35-4eca-9e6f-ad83e84829cc" class="wlWriterEditableSmartContent"><pre class="vb:nocontrols" name="code">
Dim list As New Dictionary(Of Integer, String) From {{1, "abc"}, {2, "def"}}</pre></div><p> </p><p>除此之外，我們也可以利用擴充方法增加Add副程式用來處理Collection Initializers的動作。</p><p> </p><div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:545130c7-5393-42bb-9f0e-3ba148551f41" class="wlWriterEditableSmartContent"><pre class="vb:nocontrols" name="code">
    Dim list As New List(Of Customer) From {
                                            {123, "Jonathan", "Aneja"},
                                            {456, "Lucian", "Wischik"},
                                            {789, "Paul", "Vick"}
                                           }

    Class Customer
        Property ID As Integer
        Property FirstName As String
        Property LastName As String
    End Class

    &lt;Extension()&gt;
    Sub Add(list As List(Of Customer),
            ID As Integer,
            FirstName As String,
            LastName As String)

        list.Add(New Customer With {
                                        .ID=ID,
                                        .FirstName=FirstName,
                                        .LastName=LastName
                                   })
    End Sub
</pre></div>