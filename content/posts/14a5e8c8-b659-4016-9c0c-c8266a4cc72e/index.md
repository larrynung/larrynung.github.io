---
title: "[IE8白皮書]自動損毀修復(ACR)"
date: "2013-11-06 12:00:00"
description: "[IE8白皮書]自動損毀修復(ACR)"
---

<h2>概述</h2>  <p>自動損毀修復(ACR) 是IE8的特色之一，該功能可以防止因瀏覽器當機所造成的工作流失與生產力的降低 。 自動損毀修復為IE提供了新的復原機制, 像是分頁修復(tab recovery),可有效降低使用者瀏覽網頁被中斷的機率。</p>  <p>使用者透過瀏覽器可以做很多的工作。像是: </p>  <p><strong>創作類工作</strong></p>  <p>創作類工作涉及寫作或是創作。 創作是很難的工作;且是時間密集的工作，若是不幸資料流失，將令人非常的頭痛。 創作類的工作有: </p>  <ul>   <li>電子郵件訊息 </li>    <li>部落格文章 </li>    <li>學術課件（留言板，書面轉讓，等等。 ） </li> </ul>  <p> </p>  <p><strong>具前後關聯性的工作</strong></p>  <p>雖然這類工作當發生工作流失時並不會令人非常的頭痛，但仍是令人相當沮喪的。 這類工作有: </p>  <ul>   <li>資訊搜尋與取得 </li>    <li>購物車 </li>    <li>登入Session （銀行，電子郵件，等等。 ） </li>    <li>分頁設定與載入的網址 </li>    <li>瀏覽紀錄 </li> </ul>  <p>自動損毀修復能防止在做具前後關聯與創作類工作時，因當機或非預期的應用程式關閉所造成的資料流失。</p>  <p> </p>  <h2>自動損毀修復(ACR)功能詳述</h2>  <p>下面將分別對於自動損毀修復的架構與使用者介面做一些探討。</p>  <p><strong>架構</strong></p>  <p>如下圖所示，自動損毀修復在架構上使用獨立的處理序，與介面框架獨立開來。</p>  <p><img style="border-right-width: 0px; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" border="0" alt="image" src="\images\posts\14a5e8c8-b659-4016-9c0c-c8266a4cc72e\image_thumb.png" width="706" height="588" /></a> </p>  <p>IE超過70%的當機通常是由擴充元件所造成，像是ActiveX® controls, Browser Helper Objects (BHOs), 與工具列。因此藉由把擴充的程式碼獨立到分頁處理序，我們可以保護整個瀏覽器，並把很多的錯誤給限制在分頁處理序中。</p>  <p>自動損毀修復扮演著資料記錄器的角色，可以備份分頁處理序內存在的必要資訊，包括：</p>  <ul>   <li>瀏覽記錄 </li>    <li>分頁設定(分頁網址與分頁順序) </li> </ul>  <p>下圖為自動損毀修復的高階架構示意圖：</p>  <p><a href="http://files.dotblogs.com.tw/larrynung/0904/IE8AutomaticCrashRecovery_1458F/image_4.png"><img style="border-right-width: 0px; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" border="0" alt="image" src="\images\posts\14a5e8c8-b659-4016-9c0c-c8266a4cc72e\image_thumb_1.png" width="695" height="426" /></a> </p>  <p>當整個瀏覽器損毀，或是非預期的系統關閉，persistent backing store可使瀏覽器回復到先前的瀏覽狀態。</p>  <p> </p>  <h2>使用者介面</h2>  <p>自動損毀修復具有下列功能：</p>  <p><strong>分頁修復</strong></p>  <p>如下圖所示，當損毀被成功的修復，IE會在分頁上顯示氣泡對話框來通知使用者。<a href="http://files.dotblogs.com.tw/larrynung/0904/IE8AutomaticCrashRecovery_1458F/image_6.png"><img style="border-right-width: 0px; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" border="0" alt="image" src="\images\posts\14a5e8c8-b659-4016-9c0c-c8266a4cc72e\image_thumb_2.png" width="826" height="255" /></a> </p>  <p><strong>框架修復</strong></p>  <p>當非預期的關閉發生，像是突發性的斷電，如下圖所示，IE可修復這類的問題。</p>  <p><a href="http://files.dotblogs.com.tw/larrynung/0904/IE8AutomaticCrashRecovery_1458F/image_8.png"><img style="border-right-width: 0px; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" border="0" alt="image" src="\images\posts\14a5e8c8-b659-4016-9c0c-c8266a4cc72e\image_thumb_3.png" width="879" height="401" /></p>  <p> </p>  <h2>程式範例 </h2>  <p>許多網頁並不需要修改程式就能夠正確的修復。</p>  <p>然而，當分頁修復與框架修復發生，IE將重新瀏覽目前頁面。AJAX網站動態注入的形式應當使用IE書籤頁面狀態功能，以確保當前頁面狀態能正確的恢復。</p>  <p>AJAX Navigation for Bookmarking Page State in the Browser </p>  <p>In IE8 Standards Mode, Internet Explorer treats changes in window.location.hash like navigations and saves the previous document URL. The following actions occur as a result:   </p>  <ul>   <ul />    <li>     <p>The previous URL, which might be from the previous hash fragment, is updated in the address bar, the back button, and other browser components. </p>   </li>    <li>     <p>A click sound is played just as in a traditional navigation scenario. </p>   </li>    <li>     <p>新的hashChanged事件被觸發. </p>   </li> </ul>  <p>Internet Explorer also saves the hash URL fragment before navigating away from the page. </p>  <p>下面程式碼片段介紹如何設定事件處理程序與雜湊物件去觸發瀏覽器更新它的元件：</p>  <p>// 1. 附加事件處理程序到新的onhashchange事件. </p>  <p>onhashchange = hashchange;  </p>  <p>// 2. 設定雜湊物件.  </p>  <p>window.location.hash = "Fragment_added_to_URL";</p>
