---
title: "相對路徑與絕對路徑做合併處理"
date: "2011-03-15 01:05:49"
description: "相對路徑與絕對路徑做合併處理"
tags: [CSharp,VB.NET]
---

<p>有時撰寫程式時我們會需要以當前路徑做為基底路徑，在其下面存放對應的資料，可能直接放在當前路徑下、或是放在當前路徑下面的目錄裡面，此時我們會需要以做相對路徑與絕對路徑的合併，換算所要存取的檔案的絕對路徑。</p>  <p> </p>  <p>要做相對路徑與絕對路徑做合併處理，多數人直覺想到的是System.IO.Path.Combine方法，但其實他對於此種處理並不能處理得很好，只能幫我們補個斜線並做字串的合併：</p>  <p> </p>  <p>Const basePath As String = "c:	est\123\456\789"   <br />Const relativePath As String = "..\888" </p>  <p>Console.WriteLine(System.IO.Path.Combine(basePath, relativePath))</p>  <p> </p>  <p><img style="border-bottom: 0px; border-left: 0px; border-top: 0px; border-right: 0px" border="0" alt="image" src="\images\posts\21849\image_thumb_1.png" width="393" height="175" /></a> </p>  <p> </p>  <p>若使用的是VB.NET，我們還可以透過My.Computer.FileSystem.CombinePath去做合併的動作，我們可以看到的是，透過這個方法來處理的效果比System.IO.Path.Combine好得太多了：</p>  <p> </p>  <p>Const basePath As String = "c:	est\123\456\789"   <br />Const relativePath As String = "..\888"    <br />Console.WriteLine(My.Computer.FileSystem.CombinePath(basePath, relativePath))</p>  <p> </p>  <p><a href="http://files.dotblogs.com.tw/larrynung/1103/f64d175f9bfd_B8C3/image_6.png"><img style="border-bottom: 0px; border-left: 0px; border-top: 0px; border-right: 0px" border="0" alt="image" src="\images\posts\21849\image_thumb_2.png" width="425" height="159" /></a> </p>  <p> </p>  <p>但在C#中並沒有My這樣的東西可以使用，除非將VB.NET的函示庫加入使用，不然我們就只可以透過一些小技巧來處理這樣的問題，當然這樣的技巧也能套用在VB.NET上面。像是使用System.IO.Path.Combine合併後，再透過System.IO.Path.GetFullPath去幫我們處理，或是建立Uri物件實體，並透過LocalPath屬性取得合併處理後的路徑：</p>  <p> </p>  <p>Const basePath As String = "c:	est\123\456\789"   <br />Const relativePath As String = "..\888"    <br />Console.WriteLine(System.IO.Path.GetFullPath(System.IO.Path.Combine(basePath, relativePath)))    <br />Console.WriteLine(New Uri(System.IO.Path.Combine(basePath, relativePath)).LocalPath)</p>  <p> </p>  <p><a href="http://files.dotblogs.com.tw/larrynung/1103/f64d175f9bfd_B8C3/image_8.png"><img style="border-bottom: 0px; border-left: 0px; border-top: 0px; border-right: 0px" border="0" alt="image" src="\images\posts\21849\image_thumb_3.png" width="425" height="159" /></p>
