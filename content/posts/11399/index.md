---
title: "[Visual Studio]追蹤點(Tracepoint)的使用"
date: "2009-11-04 08:38:52"
description: "[Visual Studio]追蹤點(Tracepoint)的使用"
tags: [Visual Studio]
---

<p />  <h2>追蹤點的設定與使用</h2>  <p>追蹤點在使用上跟中斷點一樣簡單。在一般的情況下，欲設定追蹤點，我們只需在欲追蹤的地方按下滑鼠右建，點選Breakpoint，接者再點下Insert Tracepoint即可。</p>  <p><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="\images\posts\11399\image_thumb.png" width="379" height="360" /></a></p>  <p> </p>  <p>若是在欲設定中斷點的地方，已經有設定了中斷點。設定的追蹤點的方式就會變為要透過[When Hit…]功能來叫起視窗設定。</p>  <p><a href="http://files.dotblogs.com.tw/larrynung/0911/VisualStudioTracepoint_1413C/image9.png" rel="lightbox"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="\images\posts\11399\image9_thumb.png" width="481" height="381" /></a> </p>  <p> </p>  <p>當做完上述動作後。如下圖，追蹤點的設定視窗即會彈出。</p>  <p> <a href="http://files.dotblogs.com.tw/larrynung/0911/VisualStudioTracepoint_1413C/image4.png" rel="lightbox"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="\images\posts\11399\image4_thumb.png" width="508" height="428" /></a></p>  <p> </p>  <p>透過彈出的設定視窗，我們可以設定我們想要追蹤的訊息。除了內建的$ADDRESS、$CALLER、$CALLSTACK、$FUNCTION、$PID、$PNAME、$TID、與$TNAME等系統資訊可供顯示外。若想要顯示的是程式中的變數或是運算，我們可以也透過"{"與"}"把想要顯示的資訊包住，來追蹤我們想看的資訊。像是： </p>  <p><a href="http://files.dotblogs.com.tw/larrynung/0911/VisualStudioTracepoint_1413C/image7.png" rel="lightbox"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="\images\posts\11399\image7_thumb.png" width="482" height="78" /></a> </p>  <p><a href="http://files.dotblogs.com.tw/larrynung/0911/VisualStudioTracepoint_1413C/image46.png" rel="lightbox"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="\images\posts\11399\image46_thumb.png" width="474" height="76" /></a></p>  <p><a href="http://files.dotblogs.com.tw/larrynung/0911/VisualStudioTracepoint_1413C/image43.png" rel="lightbox"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="\images\posts\11399\image43_thumb.png" width="478" height="74" /></a> </p>  <p> </p>  <p>設定完後，可看到追蹤點在編輯環境中是用菱形來表示。</p>  <p><a href="http://files.dotblogs.com.tw/larrynung/0911/VisualStudioTracepoint_1413C/image16.png" rel="lightbox"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="\images\posts\11399\image16_thumb.png" width="212" height="57" /></a> </p>  <p />  <p><a href="http://files.dotblogs.com.tw/larrynung/0911/VisualStudioTracepoint_1413C/image_16.png" rel="lightbox"></a></p>      <p />  <p>除錯時，我們可以透過輸出視窗、或是即時運算視窗，查看我們所設定欲追蹤的資訊。</p>  <p><a href="http://files.dotblogs.com.tw/larrynung/0911/VisualStudioTracepoint_1413C/image19.png" rel="lightbox"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="\images\posts\11399\image19_thumb.png" width="448" height="203" /></a> </p>  <p> </p>  <h2>同時使用中斷點與追蹤點</h2>  <p>若要同時使用中斷點與追蹤點的功能，只需注意需勾選[Print a message] ，並取消勾選[Continue execution]即可。</p>  <p><a href="http://files.dotblogs.com.tw/larrynung/0911/VisualStudioTracepoint_1413C/image_32.png" rel="lightbox"></a></p>  <p><a href="http://files.dotblogs.com.tw/larrynung/0911/VisualStudioTracepoint_1413C/image_41.png" rel="lightbox"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="\images\posts\11399\image_thumb_4.png" width="508" height="428" /></a> </p>  <p> </p>  <h2>設定追蹤點觸發條件</h2>  <p>Visual Studio內建有三種觸發條件可供設定。若要設定追蹤點的觸發條件，我們可以在追蹤點上按滑鼠右鍵，選取預設定的項目選單來做設定。</p>  <p><a href="http://files.dotblogs.com.tw/larrynung/0911/VisualStudioTracepoint_1413C/image58.png" rel="lightbox"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="\images\posts\11399\image58_thumb.png" width="166" height="170" /></a></p>  <p> </p>  <p>選取[Condition…]選單選項。</p>  <p><a href="http://files.dotblogs.com.tw/larrynung/0911/VisualStudioTracepoint_1413C/image34.png" rel="lightbox"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="\images\posts\11399\image34_thumb.png" width="214" height="194" /></a> </p>  <p> </p>  <p>選取後，會彈出如下[Breakpoint Condition]設定視窗。可透過該視窗設定觸發的條件。</p>  <p><a href="http://files.dotblogs.com.tw/larrynung/0911/VisualStudioTracepoint_1413C/image40.png" rel="lightbox"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="\images\posts\11399\image40_thumb.png" width="508" height="245" /></a> </p>  <p> </p>  <p>設定完後追蹤點的菱形圖示會外加個加號在上面。</p>  <p><a href="http://files.dotblogs.com.tw/larrynung/0911/VisualStudioTracepoint_1413C/image37.png" rel="lightbox"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="\images\posts\11399\image37_thumb.png" width="237" height="56" /></a> </p>  <p> </p>  <p>選取[Hit Count…]選單選項，會彈出如下[Breakpoint Hit Count]設定視窗。可透過該視窗設定第幾次進入時才觸發。 </p>  <p><a href="http://files.dotblogs.com.tw/larrynung/0911/VisualStudioTracepoint_1413C/image49.png" rel="lightbox"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="\images\posts\11399\image49_thumb.png" width="487" height="220" /></a> </p>  <p> </p>  <p>選取[Filter…]選單選項，會彈出如下[Breakpoint Filter]設定視窗。可透過該視窗設定哪個Process、哪個機器名稱、哪個執行緒才觸發。 </p>  <p><a href="http://files.dotblogs.com.tw/larrynung/0911/VisualStudioTracepoint_1413C/image52.png" rel="lightbox"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="\images\posts\11399\image52_thumb.png" width="493" height="400" /></a> </p>  <p> </p>  <h2>檢視追蹤點設定值</h2>  <p>要檢視追蹤點的設定值，我們可以把滑鼠移至追蹤點的上方。此時會顯示出如下浮動視窗，透過該浮動視窗，我們可以檢視目前的設定。</p>  <p><a href="http://files.dotblogs.com.tw/larrynung/0911/VisualStudioTracepoint_1413C/image55_1.png" rel="lightbox"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="\images\posts\11399\image55_thumb_1.png" width="782" height="129" /></a> </p>  <p />  <p />  <p />  <p />  <p />  <p />  <p />  <p />  <p />  <p />  <p />  <p />  <p />  <p />  <p />  <p />  <p />  <p />  <p />  <p> </p>  <h2>設定訊息顯示視窗</h2>  <p>追蹤點的訊息可以顯示在Ouput或是Immediate視窗。可以透過[Tools]→[Options…]叫出[Options]設定視窗，並勾選[Debugging]→[Redirect all Output Window text to the Immediate Window]來把訊息導到Immediate視窗、或是取消勾選把訊息留在輸出視窗。</p>  <p />  <p />  <p />  <p><a href="http://files.dotblogs.com.tw/larrynung/0911/VisualStudioTracepoint_1413C/image_43.png" rel="lightbox"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="\images\posts\11399\image_thumb_8.png" width="761" height="444" /></a></p>  <p> </p>  <h2>Link</h2>  <ul>   <li><em><a href="http://www.netmag.com.tw/member/netmag_article/N050103601.pdf" target="_blank">Visual Studio 2005除錯功能概覽(1) (N050103601)</a></em></li>    <li><a href="http://www.dotblogs.com.tw/hatelove/archive/2009/07/11/9353.aspx" target="_blank">[ASP.NET]Visual Studio的BreakPoint與TracePoint功能</li> </ul>
